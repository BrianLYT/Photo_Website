{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra and Zackary Jackson @ScriptedAlchemy\n*/\n\"use strict\";\n\nconst isValidExternalsType = require(\"../../schemas/plugins/container/ExternalsType.check.js\");\n\nconst SharePlugin = require(\"../sharing/SharePlugin\");\n\nconst createSchemaValidation = require(\"../util/create-schema-validation\");\n\nconst ContainerPlugin = require(\"./ContainerPlugin\");\n\nconst ContainerReferencePlugin = require(\"./ContainerReferencePlugin\");\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").ExternalsType} ExternalsType */\n\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").ModuleFederationPluginOptions} ModuleFederationPluginOptions */\n\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").Shared} Shared */\n\n/** @typedef {import(\"../Compiler\")} Compiler */\n\n\nconst validate = createSchemaValidation(require(\"../../schemas/plugins/container/ModuleFederationPlugin.check.js\"), () => require(\"../../schemas/plugins/container/ModuleFederationPlugin.json\"), {\n  name: \"Module Federation Plugin\",\n  baseDataPath: \"options\"\n});\n\nclass ModuleFederationPlugin {\n  /**\n   * @param {ModuleFederationPluginOptions} options options\n   */\n  constructor(options) {\n    validate(options);\n    this._options = options;\n  }\n  /**\n   * Apply the plugin\n   * @param {Compiler} compiler the compiler instance\n   * @returns {void}\n   */\n\n\n  apply(compiler) {\n    const {\n      _options: options\n    } = this;\n    const library = options.library || {\n      type: \"var\",\n      name: options.name\n    };\n    const remoteType = options.remoteType || (options.library && isValidExternalsType(options.library.type) ?\n    /** @type {ExternalsType} */\n    options.library.type : \"script\");\n\n    if (library && !compiler.options.output.enabledLibraryTypes.includes(library.type)) {\n      compiler.options.output.enabledLibraryTypes.push(library.type);\n    }\n\n    compiler.hooks.afterPlugins.tap(\"ModuleFederationPlugin\", () => {\n      if (options.exposes && (Array.isArray(options.exposes) ? options.exposes.length > 0 : Object.keys(options.exposes).length > 0)) {\n        new ContainerPlugin({\n          name: options.name,\n          library,\n          filename: options.filename,\n          runtime: options.runtime,\n          exposes: options.exposes\n        }).apply(compiler);\n      }\n\n      if (options.remotes && (Array.isArray(options.remotes) ? options.remotes.length > 0 : Object.keys(options.remotes).length > 0)) {\n        new ContainerReferencePlugin({\n          remoteType,\n          remotes: options.remotes\n        }).apply(compiler);\n      }\n\n      if (options.shared) {\n        new SharePlugin({\n          shared: options.shared,\n          shareScope: options.shareScope\n        }).apply(compiler);\n      }\n    });\n  }\n\n}\n\nmodule.exports = ModuleFederationPlugin;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/container/ModuleFederationPlugin.js"],"names":["isValidExternalsType","require","SharePlugin","createSchemaValidation","ContainerPlugin","ContainerReferencePlugin","validate","name","baseDataPath","ModuleFederationPlugin","constructor","options","_options","apply","compiler","library","type","remoteType","output","enabledLibraryTypes","includes","push","hooks","afterPlugins","tap","exposes","Array","isArray","length","Object","keys","filename","runtime","remotes","shared","shareScope","module","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra and Zackary Jackson @ScriptedAlchemy\n*/\n\n\"use strict\";\n\nconst isValidExternalsType = require(\"../../schemas/plugins/container/ExternalsType.check.js\");\nconst SharePlugin = require(\"../sharing/SharePlugin\");\nconst createSchemaValidation = require(\"../util/create-schema-validation\");\nconst ContainerPlugin = require(\"./ContainerPlugin\");\nconst ContainerReferencePlugin = require(\"./ContainerReferencePlugin\");\n\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").ExternalsType} ExternalsType */\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").ModuleFederationPluginOptions} ModuleFederationPluginOptions */\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").Shared} Shared */\n/** @typedef {import(\"../Compiler\")} Compiler */\n\nconst validate = createSchemaValidation(\n\trequire(\"../../schemas/plugins/container/ModuleFederationPlugin.check.js\"),\n\t() => require(\"../../schemas/plugins/container/ModuleFederationPlugin.json\"),\n\t{\n\t\tname: \"Module Federation Plugin\",\n\t\tbaseDataPath: \"options\"\n\t}\n);\nclass ModuleFederationPlugin {\n\t/**\n\t * @param {ModuleFederationPluginOptions} options options\n\t */\n\tconstructor(options) {\n\t\tvalidate(options);\n\n\t\tthis._options = options;\n\t}\n\n\t/**\n\t * Apply the plugin\n\t * @param {Compiler} compiler the compiler instance\n\t * @returns {void}\n\t */\n\tapply(compiler) {\n\t\tconst { _options: options } = this;\n\t\tconst library = options.library || { type: \"var\", name: options.name };\n\t\tconst remoteType =\n\t\t\toptions.remoteType ||\n\t\t\t(options.library && isValidExternalsType(options.library.type)\n\t\t\t\t? /** @type {ExternalsType} */ (options.library.type)\n\t\t\t\t: \"script\");\n\t\tif (\n\t\t\tlibrary &&\n\t\t\t!compiler.options.output.enabledLibraryTypes.includes(library.type)\n\t\t) {\n\t\t\tcompiler.options.output.enabledLibraryTypes.push(library.type);\n\t\t}\n\t\tcompiler.hooks.afterPlugins.tap(\"ModuleFederationPlugin\", () => {\n\t\t\tif (\n\t\t\t\toptions.exposes &&\n\t\t\t\t(Array.isArray(options.exposes)\n\t\t\t\t\t? options.exposes.length > 0\n\t\t\t\t\t: Object.keys(options.exposes).length > 0)\n\t\t\t) {\n\t\t\t\tnew ContainerPlugin({\n\t\t\t\t\tname: options.name,\n\t\t\t\t\tlibrary,\n\t\t\t\t\tfilename: options.filename,\n\t\t\t\t\truntime: options.runtime,\n\t\t\t\t\texposes: options.exposes\n\t\t\t\t}).apply(compiler);\n\t\t\t}\n\t\t\tif (\n\t\t\t\toptions.remotes &&\n\t\t\t\t(Array.isArray(options.remotes)\n\t\t\t\t\t? options.remotes.length > 0\n\t\t\t\t\t: Object.keys(options.remotes).length > 0)\n\t\t\t) {\n\t\t\t\tnew ContainerReferencePlugin({\n\t\t\t\t\tremoteType,\n\t\t\t\t\tremotes: options.remotes\n\t\t\t\t}).apply(compiler);\n\t\t\t}\n\t\t\tif (options.shared) {\n\t\t\t\tnew SharePlugin({\n\t\t\t\t\tshared: options.shared,\n\t\t\t\t\tshareScope: options.shareScope\n\t\t\t\t}).apply(compiler);\n\t\t\t}\n\t\t});\n\t}\n}\n\nmodule.exports = ModuleFederationPlugin;\n"]},"metadata":{},"sourceType":"script"}