{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst binarySearchBounds = require(\"../util/binarySearchBounds\");\n\nclass ParallelismFactorCalculator {\n  constructor() {\n    this._rangePoints = [];\n    this._rangeCallbacks = [];\n  }\n\n  range(start, end, callback) {\n    if (start === end) return callback(1);\n\n    this._rangePoints.push(start);\n\n    this._rangePoints.push(end);\n\n    this._rangeCallbacks.push(callback);\n  }\n\n  calculate() {\n    const segments = Array.from(new Set(this._rangePoints)).sort((a, b) => a < b ? -1 : 1);\n    const parallelism = segments.map(() => 0);\n    const rangeStartIndices = [];\n\n    for (let i = 0; i < this._rangePoints.length; i += 2) {\n      const start = this._rangePoints[i];\n      const end = this._rangePoints[i + 1];\n      let idx = binarySearchBounds.eq(segments, start);\n      rangeStartIndices.push(idx);\n\n      do {\n        parallelism[idx]++;\n        idx++;\n      } while (segments[idx] < end);\n    }\n\n    for (let i = 0; i < this._rangeCallbacks.length; i++) {\n      const start = this._rangePoints[i * 2];\n      const end = this._rangePoints[i * 2 + 1];\n      let idx = rangeStartIndices[i];\n      let sum = 0;\n      let totalDuration = 0;\n      let current = start;\n\n      do {\n        const p = parallelism[idx];\n        idx++;\n        const duration = segments[idx] - current;\n        totalDuration += duration;\n        current = segments[idx];\n        sum += p * duration;\n      } while (current < end);\n\n      this._rangeCallbacks[i](sum / totalDuration);\n    }\n  }\n\n}\n\nmodule.exports = ParallelismFactorCalculator;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/util/ParallelismFactorCalculator.js"],"names":["binarySearchBounds","require","ParallelismFactorCalculator","constructor","_rangePoints","_rangeCallbacks","range","start","end","callback","push","calculate","segments","Array","from","Set","sort","a","b","parallelism","map","rangeStartIndices","i","length","idx","eq","sum","totalDuration","current","p","duration","module","exports"],"mappings":"AAAA;AACA;AACA;AACA;AAEA;;AAEA,MAAMA,kBAAkB,GAAGC,OAAO,CAAC,4BAAD,CAAlC;;AAEA,MAAMC,2BAAN,CAAkC;AACjCC,EAAAA,WAAW,GAAG;AACb,SAAKC,YAAL,GAAoB,EAApB;AACA,SAAKC,eAAL,GAAuB,EAAvB;AACA;;AAEDC,EAAAA,KAAK,CAACC,KAAD,EAAQC,GAAR,EAAaC,QAAb,EAAuB;AAC3B,QAAIF,KAAK,KAAKC,GAAd,EAAmB,OAAOC,QAAQ,CAAC,CAAD,CAAf;;AACnB,SAAKL,YAAL,CAAkBM,IAAlB,CAAuBH,KAAvB;;AACA,SAAKH,YAAL,CAAkBM,IAAlB,CAAuBF,GAAvB;;AACA,SAAKH,eAAL,CAAqBK,IAArB,CAA0BD,QAA1B;AACA;;AAEDE,EAAAA,SAAS,GAAG;AACX,UAAMC,QAAQ,GAAGC,KAAK,CAACC,IAAN,CAAW,IAAIC,GAAJ,CAAQ,KAAKX,YAAb,CAAX,EAAuCY,IAAvC,CAA4C,CAACC,CAAD,EAAIC,CAAJ,KAC5DD,CAAC,GAAGC,CAAJ,GAAQ,CAAC,CAAT,GAAa,CADG,CAAjB;AAGA,UAAMC,WAAW,GAAGP,QAAQ,CAACQ,GAAT,CAAa,MAAM,CAAnB,CAApB;AACA,UAAMC,iBAAiB,GAAG,EAA1B;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKlB,YAAL,CAAkBmB,MAAtC,EAA8CD,CAAC,IAAI,CAAnD,EAAsD;AACrD,YAAMf,KAAK,GAAG,KAAKH,YAAL,CAAkBkB,CAAlB,CAAd;AACA,YAAMd,GAAG,GAAG,KAAKJ,YAAL,CAAkBkB,CAAC,GAAG,CAAtB,CAAZ;AACA,UAAIE,GAAG,GAAGxB,kBAAkB,CAACyB,EAAnB,CAAsBb,QAAtB,EAAgCL,KAAhC,CAAV;AACAc,MAAAA,iBAAiB,CAACX,IAAlB,CAAuBc,GAAvB;;AACA,SAAG;AACFL,QAAAA,WAAW,CAACK,GAAD,CAAX;AACAA,QAAAA,GAAG;AACH,OAHD,QAGSZ,QAAQ,CAACY,GAAD,CAAR,GAAgBhB,GAHzB;AAIA;;AACD,SAAK,IAAIc,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKjB,eAAL,CAAqBkB,MAAzC,EAAiDD,CAAC,EAAlD,EAAsD;AACrD,YAAMf,KAAK,GAAG,KAAKH,YAAL,CAAkBkB,CAAC,GAAG,CAAtB,CAAd;AACA,YAAMd,GAAG,GAAG,KAAKJ,YAAL,CAAkBkB,CAAC,GAAG,CAAJ,GAAQ,CAA1B,CAAZ;AACA,UAAIE,GAAG,GAAGH,iBAAiB,CAACC,CAAD,CAA3B;AACA,UAAII,GAAG,GAAG,CAAV;AACA,UAAIC,aAAa,GAAG,CAApB;AACA,UAAIC,OAAO,GAAGrB,KAAd;;AACA,SAAG;AACF,cAAMsB,CAAC,GAAGV,WAAW,CAACK,GAAD,CAArB;AACAA,QAAAA,GAAG;AACH,cAAMM,QAAQ,GAAGlB,QAAQ,CAACY,GAAD,CAAR,GAAgBI,OAAjC;AACAD,QAAAA,aAAa,IAAIG,QAAjB;AACAF,QAAAA,OAAO,GAAGhB,QAAQ,CAACY,GAAD,CAAlB;AACAE,QAAAA,GAAG,IAAIG,CAAC,GAAGC,QAAX;AACA,OAPD,QAOSF,OAAO,GAAGpB,GAPnB;;AAQA,WAAKH,eAAL,CAAqBiB,CAArB,EAAwBI,GAAG,GAAGC,aAA9B;AACA;AACD;;AA9CgC;;AAiDlCI,MAAM,CAACC,OAAP,GAAiB9B,2BAAjB","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst binarySearchBounds = require(\"../util/binarySearchBounds\");\n\nclass ParallelismFactorCalculator {\n\tconstructor() {\n\t\tthis._rangePoints = [];\n\t\tthis._rangeCallbacks = [];\n\t}\n\n\trange(start, end, callback) {\n\t\tif (start === end) return callback(1);\n\t\tthis._rangePoints.push(start);\n\t\tthis._rangePoints.push(end);\n\t\tthis._rangeCallbacks.push(callback);\n\t}\n\n\tcalculate() {\n\t\tconst segments = Array.from(new Set(this._rangePoints)).sort((a, b) =>\n\t\t\ta < b ? -1 : 1\n\t\t);\n\t\tconst parallelism = segments.map(() => 0);\n\t\tconst rangeStartIndices = [];\n\t\tfor (let i = 0; i < this._rangePoints.length; i += 2) {\n\t\t\tconst start = this._rangePoints[i];\n\t\t\tconst end = this._rangePoints[i + 1];\n\t\t\tlet idx = binarySearchBounds.eq(segments, start);\n\t\t\trangeStartIndices.push(idx);\n\t\t\tdo {\n\t\t\t\tparallelism[idx]++;\n\t\t\t\tidx++;\n\t\t\t} while (segments[idx] < end);\n\t\t}\n\t\tfor (let i = 0; i < this._rangeCallbacks.length; i++) {\n\t\t\tconst start = this._rangePoints[i * 2];\n\t\t\tconst end = this._rangePoints[i * 2 + 1];\n\t\t\tlet idx = rangeStartIndices[i];\n\t\t\tlet sum = 0;\n\t\t\tlet totalDuration = 0;\n\t\t\tlet current = start;\n\t\t\tdo {\n\t\t\t\tconst p = parallelism[idx];\n\t\t\t\tidx++;\n\t\t\t\tconst duration = segments[idx] - current;\n\t\t\t\ttotalDuration += duration;\n\t\t\t\tcurrent = segments[idx];\n\t\t\t\tsum += p * duration;\n\t\t\t} while (current < end);\n\t\t\tthis._rangeCallbacks[i](sum / totalDuration);\n\t\t}\n\t}\n}\n\nmodule.exports = ParallelismFactorCalculator;\n"]},"metadata":{},"sourceType":"script"}