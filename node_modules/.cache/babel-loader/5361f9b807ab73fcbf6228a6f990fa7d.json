{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst util = require(\"util\");\n\nconst ExternalModule = require(\"./ExternalModule\");\n\nconst {\n  resolveByProperty,\n  cachedSetProperty\n} = require(\"./util/cleverMerge\");\n/** @typedef {import(\"../declarations/WebpackOptions\").Externals} Externals */\n\n/** @typedef {import(\"./NormalModuleFactory\")} NormalModuleFactory */\n\n\nconst UNSPECIFIED_EXTERNAL_TYPE_REGEXP = /^[a-z0-9-]+ /;\nconst EMPTY_RESOLVE_OPTIONS = {}; // TODO webpack 6 remove this\n\nconst callDeprecatedExternals = util.deprecate((externalsFunction, context, request, cb) => {\n  externalsFunction.call(null, context, request, cb);\n}, \"The externals-function should be defined like ({context, request}, cb) => { ... }\", \"DEP_WEBPACK_EXTERNALS_FUNCTION_PARAMETERS\");\nconst cache = new WeakMap();\n\nconst resolveLayer = (obj, layer) => {\n  let map = cache.get(obj);\n\n  if (map === undefined) {\n    map = new Map();\n    cache.set(obj, map);\n  } else {\n    const cacheEntry = map.get(layer);\n    if (cacheEntry !== undefined) return cacheEntry;\n  }\n\n  const result = resolveByProperty(obj, \"byLayer\", layer);\n  map.set(layer, result);\n  return result;\n};\n\nclass ExternalModuleFactoryPlugin {\n  /**\n   * @param {string | undefined} type default external type\n   * @param {Externals} externals externals config\n   */\n  constructor(type, externals) {\n    this.type = type;\n    this.externals = externals;\n  }\n  /**\n   * @param {NormalModuleFactory} normalModuleFactory the normal module factory\n   * @returns {void}\n   */\n\n\n  apply(normalModuleFactory) {\n    const globalType = this.type;\n    normalModuleFactory.hooks.factorize.tapAsync(\"ExternalModuleFactoryPlugin\", (data, callback) => {\n      const context = data.context;\n      const contextInfo = data.contextInfo;\n      const dependency = data.dependencies[0];\n      const dependencyType = data.dependencyType;\n      /**\n       * @param {string|string[]|boolean|Record<string, string|string[]>} value the external config\n       * @param {string|undefined} type type of external\n       * @param {function(Error=, ExternalModule=): void} callback callback\n       * @returns {void}\n       */\n\n      const handleExternal = (value, type, callback) => {\n        if (value === false) {\n          // Not externals, fallback to original factory\n          return callback();\n        }\n        /** @type {string | string[] | Record<string, string|string[]>} */\n\n\n        let externalConfig;\n\n        if (value === true) {\n          externalConfig = dependency.request;\n        } else {\n          externalConfig = value;\n        } // When no explicit type is specified, extract it from the externalConfig\n\n\n        if (type === undefined) {\n          if (typeof externalConfig === \"string\" && UNSPECIFIED_EXTERNAL_TYPE_REGEXP.test(externalConfig)) {\n            const idx = externalConfig.indexOf(\" \");\n            type = externalConfig.substr(0, idx);\n            externalConfig = externalConfig.substr(idx + 1);\n          } else if (Array.isArray(externalConfig) && externalConfig.length > 0 && UNSPECIFIED_EXTERNAL_TYPE_REGEXP.test(externalConfig[0])) {\n            const firstItem = externalConfig[0];\n            const idx = firstItem.indexOf(\" \");\n            type = firstItem.substr(0, idx);\n            externalConfig = [firstItem.substr(idx + 1), ...externalConfig.slice(1)];\n          }\n        }\n\n        callback(null, new ExternalModule(externalConfig, type || globalType, dependency.request));\n      };\n      /**\n       * @param {Externals} externals externals config\n       * @param {function((Error | null)=, ExternalModule=): void} callback callback\n       * @returns {void}\n       */\n\n\n      const handleExternals = (externals, callback) => {\n        if (typeof externals === \"string\") {\n          if (externals === dependency.request) {\n            return handleExternal(dependency.request, undefined, callback);\n          }\n        } else if (Array.isArray(externals)) {\n          let i = 0;\n\n          const next = () => {\n            let asyncFlag;\n\n            const handleExternalsAndCallback = (err, module) => {\n              if (err) return callback(err);\n\n              if (!module) {\n                if (asyncFlag) {\n                  asyncFlag = false;\n                  return;\n                }\n\n                return next();\n              }\n\n              callback(null, module);\n            };\n\n            do {\n              asyncFlag = true;\n              if (i >= externals.length) return callback();\n              handleExternals(externals[i++], handleExternalsAndCallback);\n            } while (!asyncFlag);\n\n            asyncFlag = false;\n          };\n\n          next();\n          return;\n        } else if (externals instanceof RegExp) {\n          if (externals.test(dependency.request)) {\n            return handleExternal(dependency.request, undefined, callback);\n          }\n        } else if (typeof externals === \"function\") {\n          const cb = (err, value, type) => {\n            if (err) return callback(err);\n\n            if (value !== undefined) {\n              handleExternal(value, type, callback);\n            } else {\n              callback();\n            }\n          };\n\n          if (externals.length === 3) {\n            // TODO webpack 6 remove this\n            callDeprecatedExternals(externals, context, dependency.request, cb);\n          } else {\n            const promise = externals({\n              context,\n              request: dependency.request,\n              dependencyType,\n              contextInfo,\n              getResolve: options => (context, request, callback) => {\n                const resolveContext = {\n                  fileDependencies: data.fileDependencies,\n                  missingDependencies: data.missingDependencies,\n                  contextDependencies: data.contextDependencies\n                };\n                let resolver = normalModuleFactory.getResolver(\"normal\", dependencyType ? cachedSetProperty(data.resolveOptions || EMPTY_RESOLVE_OPTIONS, \"dependencyType\", dependencyType) : data.resolveOptions);\n                if (options) resolver = resolver.withOptions(options);\n\n                if (callback) {\n                  resolver.resolve({}, context, request, resolveContext, callback);\n                } else {\n                  return new Promise((resolve, reject) => {\n                    resolver.resolve({}, context, request, resolveContext, (err, result) => {\n                      if (err) reject(err);else resolve(result);\n                    });\n                  });\n                }\n              }\n            }, cb);\n            if (promise && promise.then) promise.then(r => cb(null, r), cb);\n          }\n\n          return;\n        } else if (typeof externals === \"object\") {\n          const resolvedExternals = resolveLayer(externals, contextInfo.issuerLayer);\n\n          if (Object.prototype.hasOwnProperty.call(resolvedExternals, dependency.request)) {\n            return handleExternal(resolvedExternals[dependency.request], undefined, callback);\n          }\n        }\n\n        callback();\n      };\n\n      handleExternals(this.externals, callback);\n    });\n  }\n\n}\n\nmodule.exports = ExternalModuleFactoryPlugin;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/ExternalModuleFactoryPlugin.js"],"names":["util","require","ExternalModule","resolveByProperty","cachedSetProperty","UNSPECIFIED_EXTERNAL_TYPE_REGEXP","EMPTY_RESOLVE_OPTIONS","callDeprecatedExternals","deprecate","externalsFunction","context","request","cb","call","cache","WeakMap","resolveLayer","obj","layer","map","get","undefined","Map","set","cacheEntry","result","ExternalModuleFactoryPlugin","constructor","type","externals","apply","normalModuleFactory","globalType","hooks","factorize","tapAsync","data","callback","contextInfo","dependency","dependencies","dependencyType","handleExternal","value","externalConfig","test","idx","indexOf","substr","Array","isArray","length","firstItem","slice","handleExternals","i","next","asyncFlag","handleExternalsAndCallback","err","module","RegExp","promise","getResolve","options","resolveContext","fileDependencies","missingDependencies","contextDependencies","resolver","getResolver","resolveOptions","withOptions","resolve","Promise","reject","then","r","resolvedExternals","issuerLayer","Object","prototype","hasOwnProperty","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst util = require(\"util\");\nconst ExternalModule = require(\"./ExternalModule\");\nconst { resolveByProperty, cachedSetProperty } = require(\"./util/cleverMerge\");\n\n/** @typedef {import(\"../declarations/WebpackOptions\").Externals} Externals */\n/** @typedef {import(\"./NormalModuleFactory\")} NormalModuleFactory */\n\nconst UNSPECIFIED_EXTERNAL_TYPE_REGEXP = /^[a-z0-9-]+ /;\nconst EMPTY_RESOLVE_OPTIONS = {};\n\n// TODO webpack 6 remove this\nconst callDeprecatedExternals = util.deprecate(\n\t(externalsFunction, context, request, cb) => {\n\t\texternalsFunction.call(null, context, request, cb);\n\t},\n\t\"The externals-function should be defined like ({context, request}, cb) => { ... }\",\n\t\"DEP_WEBPACK_EXTERNALS_FUNCTION_PARAMETERS\"\n);\n\nconst cache = new WeakMap();\n\nconst resolveLayer = (obj, layer) => {\n\tlet map = cache.get(obj);\n\tif (map === undefined) {\n\t\tmap = new Map();\n\t\tcache.set(obj, map);\n\t} else {\n\t\tconst cacheEntry = map.get(layer);\n\t\tif (cacheEntry !== undefined) return cacheEntry;\n\t}\n\tconst result = resolveByProperty(obj, \"byLayer\", layer);\n\tmap.set(layer, result);\n\treturn result;\n};\n\nclass ExternalModuleFactoryPlugin {\n\t/**\n\t * @param {string | undefined} type default external type\n\t * @param {Externals} externals externals config\n\t */\n\tconstructor(type, externals) {\n\t\tthis.type = type;\n\t\tthis.externals = externals;\n\t}\n\n\t/**\n\t * @param {NormalModuleFactory} normalModuleFactory the normal module factory\n\t * @returns {void}\n\t */\n\tapply(normalModuleFactory) {\n\t\tconst globalType = this.type;\n\t\tnormalModuleFactory.hooks.factorize.tapAsync(\n\t\t\t\"ExternalModuleFactoryPlugin\",\n\t\t\t(data, callback) => {\n\t\t\t\tconst context = data.context;\n\t\t\t\tconst contextInfo = data.contextInfo;\n\t\t\t\tconst dependency = data.dependencies[0];\n\t\t\t\tconst dependencyType = data.dependencyType;\n\n\t\t\t\t/**\n\t\t\t\t * @param {string|string[]|boolean|Record<string, string|string[]>} value the external config\n\t\t\t\t * @param {string|undefined} type type of external\n\t\t\t\t * @param {function(Error=, ExternalModule=): void} callback callback\n\t\t\t\t * @returns {void}\n\t\t\t\t */\n\t\t\t\tconst handleExternal = (value, type, callback) => {\n\t\t\t\t\tif (value === false) {\n\t\t\t\t\t\t// Not externals, fallback to original factory\n\t\t\t\t\t\treturn callback();\n\t\t\t\t\t}\n\t\t\t\t\t/** @type {string | string[] | Record<string, string|string[]>} */\n\t\t\t\t\tlet externalConfig;\n\t\t\t\t\tif (value === true) {\n\t\t\t\t\t\texternalConfig = dependency.request;\n\t\t\t\t\t} else {\n\t\t\t\t\t\texternalConfig = value;\n\t\t\t\t\t}\n\t\t\t\t\t// When no explicit type is specified, extract it from the externalConfig\n\t\t\t\t\tif (type === undefined) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\ttypeof externalConfig === \"string\" &&\n\t\t\t\t\t\t\tUNSPECIFIED_EXTERNAL_TYPE_REGEXP.test(externalConfig)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tconst idx = externalConfig.indexOf(\" \");\n\t\t\t\t\t\t\ttype = externalConfig.substr(0, idx);\n\t\t\t\t\t\t\texternalConfig = externalConfig.substr(idx + 1);\n\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\tArray.isArray(externalConfig) &&\n\t\t\t\t\t\t\texternalConfig.length > 0 &&\n\t\t\t\t\t\t\tUNSPECIFIED_EXTERNAL_TYPE_REGEXP.test(externalConfig[0])\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tconst firstItem = externalConfig[0];\n\t\t\t\t\t\t\tconst idx = firstItem.indexOf(\" \");\n\t\t\t\t\t\t\ttype = firstItem.substr(0, idx);\n\t\t\t\t\t\t\texternalConfig = [\n\t\t\t\t\t\t\t\tfirstItem.substr(idx + 1),\n\t\t\t\t\t\t\t\t...externalConfig.slice(1)\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcallback(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tnew ExternalModule(\n\t\t\t\t\t\t\texternalConfig,\n\t\t\t\t\t\t\ttype || globalType,\n\t\t\t\t\t\t\tdependency.request\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t};\n\n\t\t\t\t/**\n\t\t\t\t * @param {Externals} externals externals config\n\t\t\t\t * @param {function((Error | null)=, ExternalModule=): void} callback callback\n\t\t\t\t * @returns {void}\n\t\t\t\t */\n\t\t\t\tconst handleExternals = (externals, callback) => {\n\t\t\t\t\tif (typeof externals === \"string\") {\n\t\t\t\t\t\tif (externals === dependency.request) {\n\t\t\t\t\t\t\treturn handleExternal(dependency.request, undefined, callback);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (Array.isArray(externals)) {\n\t\t\t\t\t\tlet i = 0;\n\t\t\t\t\t\tconst next = () => {\n\t\t\t\t\t\t\tlet asyncFlag;\n\t\t\t\t\t\t\tconst handleExternalsAndCallback = (err, module) => {\n\t\t\t\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\t\t\t\tif (!module) {\n\t\t\t\t\t\t\t\t\tif (asyncFlag) {\n\t\t\t\t\t\t\t\t\t\tasyncFlag = false;\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn next();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcallback(null, module);\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\t\tasyncFlag = true;\n\t\t\t\t\t\t\t\tif (i >= externals.length) return callback();\n\t\t\t\t\t\t\t\thandleExternals(externals[i++], handleExternalsAndCallback);\n\t\t\t\t\t\t\t} while (!asyncFlag);\n\t\t\t\t\t\t\tasyncFlag = false;\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tnext();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (externals instanceof RegExp) {\n\t\t\t\t\t\tif (externals.test(dependency.request)) {\n\t\t\t\t\t\t\treturn handleExternal(dependency.request, undefined, callback);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (typeof externals === \"function\") {\n\t\t\t\t\t\tconst cb = (err, value, type) => {\n\t\t\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\t\t\tif (value !== undefined) {\n\t\t\t\t\t\t\t\thandleExternal(value, type, callback);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (externals.length === 3) {\n\t\t\t\t\t\t\t// TODO webpack 6 remove this\n\t\t\t\t\t\t\tcallDeprecatedExternals(\n\t\t\t\t\t\t\t\texternals,\n\t\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\t\tdependency.request,\n\t\t\t\t\t\t\t\tcb\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst promise = externals(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\t\t\trequest: dependency.request,\n\t\t\t\t\t\t\t\t\tdependencyType,\n\t\t\t\t\t\t\t\t\tcontextInfo,\n\t\t\t\t\t\t\t\t\tgetResolve: options => (context, request, callback) => {\n\t\t\t\t\t\t\t\t\t\tconst resolveContext = {\n\t\t\t\t\t\t\t\t\t\t\tfileDependencies: data.fileDependencies,\n\t\t\t\t\t\t\t\t\t\t\tmissingDependencies: data.missingDependencies,\n\t\t\t\t\t\t\t\t\t\t\tcontextDependencies: data.contextDependencies\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\tlet resolver = normalModuleFactory.getResolver(\n\t\t\t\t\t\t\t\t\t\t\t\"normal\",\n\t\t\t\t\t\t\t\t\t\t\tdependencyType\n\t\t\t\t\t\t\t\t\t\t\t\t? cachedSetProperty(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.resolveOptions || EMPTY_RESOLVE_OPTIONS,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"dependencyType\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdependencyType\n\t\t\t\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t\t\t\t: data.resolveOptions\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tif (options) resolver = resolver.withOptions(options);\n\t\t\t\t\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\t\t\t\t\tresolver.resolve(\n\t\t\t\t\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\t\t\t\t\t\trequest,\n\t\t\t\t\t\t\t\t\t\t\t\tresolveContext,\n\t\t\t\t\t\t\t\t\t\t\t\tcallback\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t\t\t\t\t\t\t\tresolver.resolve(\n\t\t\t\t\t\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\t\t\t\t\t\t\trequest,\n\t\t\t\t\t\t\t\t\t\t\t\t\tresolveContext,\n\t\t\t\t\t\t\t\t\t\t\t\t\t(err, result) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse resolve(result);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcb\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (promise && promise.then) promise.then(r => cb(null, r), cb);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (typeof externals === \"object\") {\n\t\t\t\t\t\tconst resolvedExternals = resolveLayer(\n\t\t\t\t\t\t\texternals,\n\t\t\t\t\t\t\tcontextInfo.issuerLayer\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tObject.prototype.hasOwnProperty.call(\n\t\t\t\t\t\t\t\tresolvedExternals,\n\t\t\t\t\t\t\t\tdependency.request\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn handleExternal(\n\t\t\t\t\t\t\t\tresolvedExternals[dependency.request],\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\tcallback\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcallback();\n\t\t\t\t};\n\n\t\t\t\thandleExternals(this.externals, callback);\n\t\t\t}\n\t\t);\n\t}\n}\nmodule.exports = ExternalModuleFactoryPlugin;\n"]},"metadata":{},"sourceType":"script"}