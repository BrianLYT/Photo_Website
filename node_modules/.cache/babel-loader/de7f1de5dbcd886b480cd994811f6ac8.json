{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst {\n  RawSource\n} = require(\"webpack-sources\");\n\nconst {\n  UsageState\n} = require(\"../ExportsInfo\");\n\nconst Generator = require(\"../Generator\");\n\nconst InitFragment = require(\"../InitFragment\");\n\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\n\nconst Template = require(\"../Template\");\n\nconst ModuleDependency = require(\"../dependencies/ModuleDependency\");\n\nconst WebAssemblyExportImportedDependency = require(\"../dependencies/WebAssemblyExportImportedDependency\");\n\nconst WebAssemblyImportDependency = require(\"../dependencies/WebAssemblyImportDependency\");\n/** @typedef {import(\"webpack-sources\").Source} Source */\n\n/** @typedef {import(\"../Dependency\")} Dependency */\n\n/** @typedef {import(\"../DependencyTemplates\")} DependencyTemplates */\n\n/** @typedef {import(\"../Generator\").GenerateContext} GenerateContext */\n\n/** @typedef {import(\"../NormalModule\")} NormalModule */\n\n/** @typedef {import(\"../RuntimeTemplate\")} RuntimeTemplate */\n\n\nconst TYPES = new Set([\"webassembly\"]);\n\nclass WebAssemblyJavascriptGenerator extends Generator {\n  /**\n   * @param {NormalModule} module fresh module\n   * @returns {Set<string>} available types (do not mutate)\n   */\n  getTypes(module) {\n    return TYPES;\n  }\n  /**\n   * @param {NormalModule} module the module\n   * @param {string=} type source type\n   * @returns {number} estimate size of the module\n   */\n\n\n  getSize(module, type) {\n    return 95 + module.dependencies.length * 5;\n  }\n  /**\n   * @param {NormalModule} module module for which the code should be generated\n   * @param {GenerateContext} generateContext context for generate\n   * @returns {Source} generated code\n   */\n\n\n  generate(module, generateContext) {\n    const {\n      runtimeTemplate,\n      moduleGraph,\n      chunkGraph,\n      runtimeRequirements,\n      runtime\n    } = generateContext;\n    /** @type {InitFragment[]} */\n\n    const initFragments = [];\n    const exportsInfo = moduleGraph.getExportsInfo(module);\n    let needExportsCopy = false;\n    const importedModules = new Map();\n    const initParams = [];\n    let index = 0;\n\n    for (const dep of module.dependencies) {\n      const moduleDep = dep && dep instanceof ModuleDependency ? dep : undefined;\n\n      if (moduleGraph.getModule(dep)) {\n        let importData = importedModules.get(moduleGraph.getModule(dep));\n\n        if (importData === undefined) {\n          importedModules.set(moduleGraph.getModule(dep), importData = {\n            importVar: `m${index}`,\n            index,\n            request: moduleDep && moduleDep.userRequest || undefined,\n            names: new Set(),\n            reexports: []\n          });\n          index++;\n        }\n\n        if (dep instanceof WebAssemblyImportDependency) {\n          importData.names.add(dep.name);\n\n          if (dep.description.type === \"GlobalType\") {\n            const exportName = dep.name;\n            const importedModule = moduleGraph.getModule(dep);\n\n            if (importedModule) {\n              const usedName = moduleGraph.getExportsInfo(importedModule).getUsedName(exportName, runtime);\n\n              if (usedName) {\n                initParams.push(runtimeTemplate.exportFromImport({\n                  moduleGraph,\n                  module: importedModule,\n                  request: dep.request,\n                  importVar: importData.importVar,\n                  originModule: module,\n                  exportName: dep.name,\n                  asiSafe: true,\n                  isCall: false,\n                  callContext: null,\n                  defaultInterop: true,\n                  initFragments,\n                  runtime,\n                  runtimeRequirements\n                }));\n              }\n            }\n          }\n        }\n\n        if (dep instanceof WebAssemblyExportImportedDependency) {\n          importData.names.add(dep.name);\n          const usedName = moduleGraph.getExportsInfo(module).getUsedName(dep.exportName, runtime);\n\n          if (usedName) {\n            runtimeRequirements.add(RuntimeGlobals.exports);\n            const exportProp = `${module.exportsArgument}[${JSON.stringify(usedName)}]`;\n            const defineStatement = Template.asString([`${exportProp} = ${runtimeTemplate.exportFromImport({\n              moduleGraph,\n              module: moduleGraph.getModule(dep),\n              request: dep.request,\n              importVar: importData.importVar,\n              originModule: module,\n              exportName: dep.name,\n              asiSafe: true,\n              isCall: false,\n              callContext: null,\n              defaultInterop: true,\n              initFragments,\n              runtime,\n              runtimeRequirements\n            })};`, `if(WebAssembly.Global) ${exportProp} = ` + `new WebAssembly.Global({ value: ${JSON.stringify(dep.valueType)} }, ${exportProp});`]);\n            importData.reexports.push(defineStatement);\n            needExportsCopy = true;\n          }\n        }\n      }\n    }\n\n    const importsCode = Template.asString(Array.from(importedModules, _ref => {\n      let [module, {\n        importVar,\n        request,\n        reexports\n      }] = _ref;\n      const importStatement = runtimeTemplate.importStatement({\n        module,\n        chunkGraph,\n        request,\n        importVar,\n        originModule: module,\n        runtimeRequirements\n      });\n      return importStatement[0] + importStatement[1] + reexports.join(\"\\n\");\n    }));\n    const copyAllExports = exportsInfo.otherExportsInfo.getUsed(runtime) === UsageState.Unused && !needExportsCopy; // need these globals\n\n    runtimeRequirements.add(RuntimeGlobals.module);\n    runtimeRequirements.add(RuntimeGlobals.moduleId);\n    runtimeRequirements.add(RuntimeGlobals.wasmInstances);\n\n    if (exportsInfo.otherExportsInfo.getUsed(runtime) !== UsageState.Unused) {\n      runtimeRequirements.add(RuntimeGlobals.makeNamespaceObject);\n      runtimeRequirements.add(RuntimeGlobals.exports);\n    }\n\n    if (!copyAllExports) {\n      runtimeRequirements.add(RuntimeGlobals.exports);\n    } // create source\n\n\n    const source = new RawSource(['\"use strict\";', \"// Instantiate WebAssembly module\", `var wasmExports = ${RuntimeGlobals.wasmInstances}[${module.moduleArgument}.id];`, exportsInfo.otherExportsInfo.getUsed(runtime) !== UsageState.Unused ? `${RuntimeGlobals.makeNamespaceObject}(${module.exportsArgument});` : \"\", // this must be before import for circular dependencies\n    \"// export exports from WebAssembly module\", copyAllExports ? `${module.moduleArgument}.exports = wasmExports;` : \"for(var name in wasmExports) \" + `if(name) ` + `${module.exportsArgument}[name] = wasmExports[name];`, \"// exec imports from WebAssembly module (for esm order)\", importsCode, \"\", \"// exec wasm module\", `wasmExports[\"\"](${initParams.join(\", \")})`].join(\"\\n\"));\n    return InitFragment.addToSource(source, initFragments, generateContext);\n  }\n\n}\n\nmodule.exports = WebAssemblyJavascriptGenerator;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/wasm-sync/WebAssemblyJavascriptGenerator.js"],"names":["RawSource","require","UsageState","Generator","InitFragment","RuntimeGlobals","Template","ModuleDependency","WebAssemblyExportImportedDependency","WebAssemblyImportDependency","TYPES","Set","WebAssemblyJavascriptGenerator","getTypes","module","getSize","type","dependencies","length","generate","generateContext","runtimeTemplate","moduleGraph","chunkGraph","runtimeRequirements","runtime","initFragments","exportsInfo","getExportsInfo","needExportsCopy","importedModules","Map","initParams","index","dep","moduleDep","undefined","getModule","importData","get","set","importVar","request","userRequest","names","reexports","add","name","description","exportName","importedModule","usedName","getUsedName","push","exportFromImport","originModule","asiSafe","isCall","callContext","defaultInterop","exports","exportProp","exportsArgument","JSON","stringify","defineStatement","asString","valueType","importsCode","Array","from","importStatement","join","copyAllExports","otherExportsInfo","getUsed","Unused","moduleId","wasmInstances","makeNamespaceObject","source","moduleArgument","addToSource"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst { RawSource } = require(\"webpack-sources\");\nconst { UsageState } = require(\"../ExportsInfo\");\nconst Generator = require(\"../Generator\");\nconst InitFragment = require(\"../InitFragment\");\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\nconst Template = require(\"../Template\");\nconst ModuleDependency = require(\"../dependencies/ModuleDependency\");\nconst WebAssemblyExportImportedDependency = require(\"../dependencies/WebAssemblyExportImportedDependency\");\nconst WebAssemblyImportDependency = require(\"../dependencies/WebAssemblyImportDependency\");\n\n/** @typedef {import(\"webpack-sources\").Source} Source */\n/** @typedef {import(\"../Dependency\")} Dependency */\n/** @typedef {import(\"../DependencyTemplates\")} DependencyTemplates */\n/** @typedef {import(\"../Generator\").GenerateContext} GenerateContext */\n/** @typedef {import(\"../NormalModule\")} NormalModule */\n/** @typedef {import(\"../RuntimeTemplate\")} RuntimeTemplate */\n\nconst TYPES = new Set([\"webassembly\"]);\n\nclass WebAssemblyJavascriptGenerator extends Generator {\n\t/**\n\t * @param {NormalModule} module fresh module\n\t * @returns {Set<string>} available types (do not mutate)\n\t */\n\tgetTypes(module) {\n\t\treturn TYPES;\n\t}\n\n\t/**\n\t * @param {NormalModule} module the module\n\t * @param {string=} type source type\n\t * @returns {number} estimate size of the module\n\t */\n\tgetSize(module, type) {\n\t\treturn 95 + module.dependencies.length * 5;\n\t}\n\n\t/**\n\t * @param {NormalModule} module module for which the code should be generated\n\t * @param {GenerateContext} generateContext context for generate\n\t * @returns {Source} generated code\n\t */\n\tgenerate(module, generateContext) {\n\t\tconst {\n\t\t\truntimeTemplate,\n\t\t\tmoduleGraph,\n\t\t\tchunkGraph,\n\t\t\truntimeRequirements,\n\t\t\truntime\n\t\t} = generateContext;\n\t\t/** @type {InitFragment[]} */\n\t\tconst initFragments = [];\n\n\t\tconst exportsInfo = moduleGraph.getExportsInfo(module);\n\n\t\tlet needExportsCopy = false;\n\t\tconst importedModules = new Map();\n\t\tconst initParams = [];\n\t\tlet index = 0;\n\t\tfor (const dep of module.dependencies) {\n\t\t\tconst moduleDep =\n\t\t\t\tdep && dep instanceof ModuleDependency ? dep : undefined;\n\t\t\tif (moduleGraph.getModule(dep)) {\n\t\t\t\tlet importData = importedModules.get(moduleGraph.getModule(dep));\n\t\t\t\tif (importData === undefined) {\n\t\t\t\t\timportedModules.set(\n\t\t\t\t\t\tmoduleGraph.getModule(dep),\n\t\t\t\t\t\t(importData = {\n\t\t\t\t\t\t\timportVar: `m${index}`,\n\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\trequest: (moduleDep && moduleDep.userRequest) || undefined,\n\t\t\t\t\t\t\tnames: new Set(),\n\t\t\t\t\t\t\treexports: []\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\tindex++;\n\t\t\t\t}\n\t\t\t\tif (dep instanceof WebAssemblyImportDependency) {\n\t\t\t\t\timportData.names.add(dep.name);\n\t\t\t\t\tif (dep.description.type === \"GlobalType\") {\n\t\t\t\t\t\tconst exportName = dep.name;\n\t\t\t\t\t\tconst importedModule = moduleGraph.getModule(dep);\n\n\t\t\t\t\t\tif (importedModule) {\n\t\t\t\t\t\t\tconst usedName = moduleGraph\n\t\t\t\t\t\t\t\t.getExportsInfo(importedModule)\n\t\t\t\t\t\t\t\t.getUsedName(exportName, runtime);\n\t\t\t\t\t\t\tif (usedName) {\n\t\t\t\t\t\t\t\tinitParams.push(\n\t\t\t\t\t\t\t\t\truntimeTemplate.exportFromImport({\n\t\t\t\t\t\t\t\t\t\tmoduleGraph,\n\t\t\t\t\t\t\t\t\t\tmodule: importedModule,\n\t\t\t\t\t\t\t\t\t\trequest: dep.request,\n\t\t\t\t\t\t\t\t\t\timportVar: importData.importVar,\n\t\t\t\t\t\t\t\t\t\toriginModule: module,\n\t\t\t\t\t\t\t\t\t\texportName: dep.name,\n\t\t\t\t\t\t\t\t\t\tasiSafe: true,\n\t\t\t\t\t\t\t\t\t\tisCall: false,\n\t\t\t\t\t\t\t\t\t\tcallContext: null,\n\t\t\t\t\t\t\t\t\t\tdefaultInterop: true,\n\t\t\t\t\t\t\t\t\t\tinitFragments,\n\t\t\t\t\t\t\t\t\t\truntime,\n\t\t\t\t\t\t\t\t\t\truntimeRequirements\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (dep instanceof WebAssemblyExportImportedDependency) {\n\t\t\t\t\timportData.names.add(dep.name);\n\t\t\t\t\tconst usedName = moduleGraph\n\t\t\t\t\t\t.getExportsInfo(module)\n\t\t\t\t\t\t.getUsedName(dep.exportName, runtime);\n\t\t\t\t\tif (usedName) {\n\t\t\t\t\t\truntimeRequirements.add(RuntimeGlobals.exports);\n\t\t\t\t\t\tconst exportProp = `${module.exportsArgument}[${JSON.stringify(\n\t\t\t\t\t\t\tusedName\n\t\t\t\t\t\t)}]`;\n\t\t\t\t\t\tconst defineStatement = Template.asString([\n\t\t\t\t\t\t\t`${exportProp} = ${runtimeTemplate.exportFromImport({\n\t\t\t\t\t\t\t\tmoduleGraph,\n\t\t\t\t\t\t\t\tmodule: moduleGraph.getModule(dep),\n\t\t\t\t\t\t\t\trequest: dep.request,\n\t\t\t\t\t\t\t\timportVar: importData.importVar,\n\t\t\t\t\t\t\t\toriginModule: module,\n\t\t\t\t\t\t\t\texportName: dep.name,\n\t\t\t\t\t\t\t\tasiSafe: true,\n\t\t\t\t\t\t\t\tisCall: false,\n\t\t\t\t\t\t\t\tcallContext: null,\n\t\t\t\t\t\t\t\tdefaultInterop: true,\n\t\t\t\t\t\t\t\tinitFragments,\n\t\t\t\t\t\t\t\truntime,\n\t\t\t\t\t\t\t\truntimeRequirements\n\t\t\t\t\t\t\t})};`,\n\t\t\t\t\t\t\t`if(WebAssembly.Global) ${exportProp} = ` +\n\t\t\t\t\t\t\t\t`new WebAssembly.Global({ value: ${JSON.stringify(\n\t\t\t\t\t\t\t\t\tdep.valueType\n\t\t\t\t\t\t\t\t)} }, ${exportProp});`\n\t\t\t\t\t\t]);\n\t\t\t\t\t\timportData.reexports.push(defineStatement);\n\t\t\t\t\t\tneedExportsCopy = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst importsCode = Template.asString(\n\t\t\tArray.from(\n\t\t\t\timportedModules,\n\t\t\t\t([module, { importVar, request, reexports }]) => {\n\t\t\t\t\tconst importStatement = runtimeTemplate.importStatement({\n\t\t\t\t\t\tmodule,\n\t\t\t\t\t\tchunkGraph,\n\t\t\t\t\t\trequest,\n\t\t\t\t\t\timportVar,\n\t\t\t\t\t\toriginModule: module,\n\t\t\t\t\t\truntimeRequirements\n\t\t\t\t\t});\n\t\t\t\t\treturn importStatement[0] + importStatement[1] + reexports.join(\"\\n\");\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst copyAllExports =\n\t\t\texportsInfo.otherExportsInfo.getUsed(runtime) === UsageState.Unused &&\n\t\t\t!needExportsCopy;\n\n\t\t// need these globals\n\t\truntimeRequirements.add(RuntimeGlobals.module);\n\t\truntimeRequirements.add(RuntimeGlobals.moduleId);\n\t\truntimeRequirements.add(RuntimeGlobals.wasmInstances);\n\t\tif (exportsInfo.otherExportsInfo.getUsed(runtime) !== UsageState.Unused) {\n\t\t\truntimeRequirements.add(RuntimeGlobals.makeNamespaceObject);\n\t\t\truntimeRequirements.add(RuntimeGlobals.exports);\n\t\t}\n\t\tif (!copyAllExports) {\n\t\t\truntimeRequirements.add(RuntimeGlobals.exports);\n\t\t}\n\n\t\t// create source\n\t\tconst source = new RawSource(\n\t\t\t[\n\t\t\t\t'\"use strict\";',\n\t\t\t\t\"// Instantiate WebAssembly module\",\n\t\t\t\t`var wasmExports = ${RuntimeGlobals.wasmInstances}[${module.moduleArgument}.id];`,\n\n\t\t\t\texportsInfo.otherExportsInfo.getUsed(runtime) !== UsageState.Unused\n\t\t\t\t\t? `${RuntimeGlobals.makeNamespaceObject}(${module.exportsArgument});`\n\t\t\t\t\t: \"\",\n\n\t\t\t\t// this must be before import for circular dependencies\n\t\t\t\t\"// export exports from WebAssembly module\",\n\t\t\t\tcopyAllExports\n\t\t\t\t\t? `${module.moduleArgument}.exports = wasmExports;`\n\t\t\t\t\t: \"for(var name in wasmExports) \" +\n\t\t\t\t\t  `if(name) ` +\n\t\t\t\t\t  `${module.exportsArgument}[name] = wasmExports[name];`,\n\t\t\t\t\"// exec imports from WebAssembly module (for esm order)\",\n\t\t\t\timportsCode,\n\t\t\t\t\"\",\n\t\t\t\t\"// exec wasm module\",\n\t\t\t\t`wasmExports[\"\"](${initParams.join(\", \")})`\n\t\t\t].join(\"\\n\")\n\t\t);\n\t\treturn InitFragment.addToSource(source, initFragments, generateContext);\n\t}\n}\n\nmodule.exports = WebAssemblyJavascriptGenerator;\n"]},"metadata":{},"sourceType":"script"}