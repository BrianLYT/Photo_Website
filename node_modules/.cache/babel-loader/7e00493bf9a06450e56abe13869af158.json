{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Sergey Melyukov @smelukov\n*/\n\"use strict\";\n\nconst InnerGraph = require(\"./optimize/InnerGraph\");\n/** @typedef {import(\"./Compiler\")} Compiler */\n\n/** @typedef {import(\"./javascript/JavascriptParser\")} JavascriptParser */\n\n\nclass JavascriptMetaInfoPlugin {\n  /**\n   * Apply the plugin\n   * @param {Compiler} compiler the compiler instance\n   * @returns {void}\n   */\n  apply(compiler) {\n    compiler.hooks.compilation.tap(\"JavascriptMetaInfoPlugin\", (compilation, _ref) => {\n      let {\n        normalModuleFactory\n      } = _ref;\n\n      /**\n       * @param {JavascriptParser} parser the parser\n       * @returns {void}\n       */\n      const handler = parser => {\n        parser.hooks.call.for(\"eval\").tap(\"JavascriptMetaInfoPlugin\", () => {\n          parser.state.module.buildInfo.moduleConcatenationBailout = \"eval()\";\n          parser.state.module.buildInfo.usingEval = true;\n          const currentSymbol = InnerGraph.getTopLevelSymbol(parser.state);\n\n          if (currentSymbol) {\n            InnerGraph.addUsage(parser.state, null, currentSymbol);\n          } else {\n            InnerGraph.bailout(parser.state);\n          }\n        });\n        parser.hooks.finish.tap(\"JavascriptMetaInfoPlugin\", () => {\n          let topLevelDeclarations = parser.state.module.buildInfo.topLevelDeclarations;\n\n          if (topLevelDeclarations === undefined) {\n            topLevelDeclarations = parser.state.module.buildInfo.topLevelDeclarations = new Set();\n          }\n\n          for (const name of parser.scope.definitions.asSet()) {\n            const freeInfo = parser.getFreeInfoFromVariable(name);\n\n            if (freeInfo === undefined) {\n              topLevelDeclarations.add(name);\n            }\n          }\n        });\n      };\n\n      normalModuleFactory.hooks.parser.for(\"javascript/auto\").tap(\"JavascriptMetaInfoPlugin\", handler);\n      normalModuleFactory.hooks.parser.for(\"javascript/dynamic\").tap(\"JavascriptMetaInfoPlugin\", handler);\n      normalModuleFactory.hooks.parser.for(\"javascript/esm\").tap(\"JavascriptMetaInfoPlugin\", handler);\n    });\n  }\n\n}\n\nmodule.exports = JavascriptMetaInfoPlugin;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/JavascriptMetaInfoPlugin.js"],"names":["InnerGraph","require","JavascriptMetaInfoPlugin","apply","compiler","hooks","compilation","tap","normalModuleFactory","handler","parser","call","for","state","module","buildInfo","moduleConcatenationBailout","usingEval","currentSymbol","getTopLevelSymbol","addUsage","bailout","finish","topLevelDeclarations","undefined","Set","name","scope","definitions","asSet","freeInfo","getFreeInfoFromVariable","add","exports"],"mappings":"AAAA;AACA;AACA;AACA;AAEA;;AAEA,MAAMA,UAAU,GAAGC,OAAO,CAAC,uBAAD,CAA1B;AAEA;;AACA;;;AAEA,MAAMC,wBAAN,CAA+B;AAC9B;AACD;AACA;AACA;AACA;AACCC,EAAAA,KAAK,CAACC,QAAD,EAAW;AACfA,IAAAA,QAAQ,CAACC,KAAT,CAAeC,WAAf,CAA2BC,GAA3B,CACC,0BADD,EAEC,CAACD,WAAD,WAA0C;AAAA,UAA5B;AAAEE,QAAAA;AAAF,OAA4B;;AACzC;AACJ;AACA;AACA;AACI,YAAMC,OAAO,GAAGC,MAAM,IAAI;AACzBA,QAAAA,MAAM,CAACL,KAAP,CAAaM,IAAb,CAAkBC,GAAlB,CAAsB,MAAtB,EAA8BL,GAA9B,CAAkC,0BAAlC,EAA8D,MAAM;AACnEG,UAAAA,MAAM,CAACG,KAAP,CAAaC,MAAb,CAAoBC,SAApB,CAA8BC,0BAA9B,GAA2D,QAA3D;AACAN,UAAAA,MAAM,CAACG,KAAP,CAAaC,MAAb,CAAoBC,SAApB,CAA8BE,SAA9B,GAA0C,IAA1C;AACA,gBAAMC,aAAa,GAAGlB,UAAU,CAACmB,iBAAX,CAA6BT,MAAM,CAACG,KAApC,CAAtB;;AACA,cAAIK,aAAJ,EAAmB;AAClBlB,YAAAA,UAAU,CAACoB,QAAX,CAAoBV,MAAM,CAACG,KAA3B,EAAkC,IAAlC,EAAwCK,aAAxC;AACA,WAFD,MAEO;AACNlB,YAAAA,UAAU,CAACqB,OAAX,CAAmBX,MAAM,CAACG,KAA1B;AACA;AACD,SATD;AAUAH,QAAAA,MAAM,CAACL,KAAP,CAAaiB,MAAb,CAAoBf,GAApB,CAAwB,0BAAxB,EAAoD,MAAM;AACzD,cAAIgB,oBAAoB,GACvBb,MAAM,CAACG,KAAP,CAAaC,MAAb,CAAoBC,SAApB,CAA8BQ,oBAD/B;;AAEA,cAAIA,oBAAoB,KAAKC,SAA7B,EAAwC;AACvCD,YAAAA,oBAAoB,GACnBb,MAAM,CAACG,KAAP,CAAaC,MAAb,CAAoBC,SAApB,CAA8BQ,oBAA9B,GAAqD,IAAIE,GAAJ,EADtD;AAEA;;AACD,eAAK,MAAMC,IAAX,IAAmBhB,MAAM,CAACiB,KAAP,CAAaC,WAAb,CAAyBC,KAAzB,EAAnB,EAAqD;AACpD,kBAAMC,QAAQ,GAAGpB,MAAM,CAACqB,uBAAP,CAA+BL,IAA/B,CAAjB;;AACA,gBAAII,QAAQ,KAAKN,SAAjB,EAA4B;AAC3BD,cAAAA,oBAAoB,CAACS,GAArB,CAAyBN,IAAzB;AACA;AACD;AACD,SAbD;AAcA,OAzBD;;AA2BAlB,MAAAA,mBAAmB,CAACH,KAApB,CAA0BK,MAA1B,CACEE,GADF,CACM,iBADN,EAEEL,GAFF,CAEM,0BAFN,EAEkCE,OAFlC;AAGAD,MAAAA,mBAAmB,CAACH,KAApB,CAA0BK,MAA1B,CACEE,GADF,CACM,oBADN,EAEEL,GAFF,CAEM,0BAFN,EAEkCE,OAFlC;AAGAD,MAAAA,mBAAmB,CAACH,KAApB,CAA0BK,MAA1B,CACEE,GADF,CACM,gBADN,EAEEL,GAFF,CAEM,0BAFN,EAEkCE,OAFlC;AAGA,KA3CF;AA6CA;;AApD6B;;AAuD/BK,MAAM,CAACmB,OAAP,GAAiB/B,wBAAjB","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Sergey Melyukov @smelukov\n*/\n\n\"use strict\";\n\nconst InnerGraph = require(\"./optimize/InnerGraph\");\n\n/** @typedef {import(\"./Compiler\")} Compiler */\n/** @typedef {import(\"./javascript/JavascriptParser\")} JavascriptParser */\n\nclass JavascriptMetaInfoPlugin {\n\t/**\n\t * Apply the plugin\n\t * @param {Compiler} compiler the compiler instance\n\t * @returns {void}\n\t */\n\tapply(compiler) {\n\t\tcompiler.hooks.compilation.tap(\n\t\t\t\"JavascriptMetaInfoPlugin\",\n\t\t\t(compilation, { normalModuleFactory }) => {\n\t\t\t\t/**\n\t\t\t\t * @param {JavascriptParser} parser the parser\n\t\t\t\t * @returns {void}\n\t\t\t\t */\n\t\t\t\tconst handler = parser => {\n\t\t\t\t\tparser.hooks.call.for(\"eval\").tap(\"JavascriptMetaInfoPlugin\", () => {\n\t\t\t\t\t\tparser.state.module.buildInfo.moduleConcatenationBailout = \"eval()\";\n\t\t\t\t\t\tparser.state.module.buildInfo.usingEval = true;\n\t\t\t\t\t\tconst currentSymbol = InnerGraph.getTopLevelSymbol(parser.state);\n\t\t\t\t\t\tif (currentSymbol) {\n\t\t\t\t\t\t\tInnerGraph.addUsage(parser.state, null, currentSymbol);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tInnerGraph.bailout(parser.state);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tparser.hooks.finish.tap(\"JavascriptMetaInfoPlugin\", () => {\n\t\t\t\t\t\tlet topLevelDeclarations =\n\t\t\t\t\t\t\tparser.state.module.buildInfo.topLevelDeclarations;\n\t\t\t\t\t\tif (topLevelDeclarations === undefined) {\n\t\t\t\t\t\t\ttopLevelDeclarations =\n\t\t\t\t\t\t\t\tparser.state.module.buildInfo.topLevelDeclarations = new Set();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (const name of parser.scope.definitions.asSet()) {\n\t\t\t\t\t\t\tconst freeInfo = parser.getFreeInfoFromVariable(name);\n\t\t\t\t\t\t\tif (freeInfo === undefined) {\n\t\t\t\t\t\t\t\ttopLevelDeclarations.add(name);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(\"javascript/auto\")\n\t\t\t\t\t.tap(\"JavascriptMetaInfoPlugin\", handler);\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(\"javascript/dynamic\")\n\t\t\t\t\t.tap(\"JavascriptMetaInfoPlugin\", handler);\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(\"javascript/esm\")\n\t\t\t\t\t.tap(\"JavascriptMetaInfoPlugin\", handler);\n\t\t\t}\n\t\t);\n\t}\n}\n\nmodule.exports = JavascriptMetaInfoPlugin;\n"]},"metadata":{},"sourceType":"script"}