{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst CommentCompilationWarning = require(\"../CommentCompilationWarning\");\n\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\n\nconst UnsupportedFeatureWarning = require(\"../UnsupportedFeatureWarning\");\n\nconst {\n  evaluateToIdentifier,\n  evaluateToString,\n  expressionIsUnsupported,\n  toConstantDependency\n} = require(\"../javascript/JavascriptParserHelpers\");\n\nconst CommonJsFullRequireDependency = require(\"./CommonJsFullRequireDependency\");\n\nconst CommonJsRequireContextDependency = require(\"./CommonJsRequireContextDependency\");\n\nconst CommonJsRequireDependency = require(\"./CommonJsRequireDependency\");\n\nconst ConstDependency = require(\"./ConstDependency\");\n\nconst ContextDependencyHelpers = require(\"./ContextDependencyHelpers\");\n\nconst LocalModuleDependency = require(\"./LocalModuleDependency\");\n\nconst {\n  getLocalModule\n} = require(\"./LocalModulesHelpers\");\n\nconst RequireHeaderDependency = require(\"./RequireHeaderDependency\");\n\nconst RequireResolveContextDependency = require(\"./RequireResolveContextDependency\");\n\nconst RequireResolveDependency = require(\"./RequireResolveDependency\");\n\nconst RequireResolveHeaderDependency = require(\"./RequireResolveHeaderDependency\");\n/** @typedef {import(\"../../declarations/WebpackOptions\").JavascriptParserOptions} JavascriptParserOptions */\n\n\nclass CommonJsImportsParserPlugin {\n  /**\n   * @param {JavascriptParserOptions} options parser options\n   */\n  constructor(options) {\n    this.options = options;\n  }\n\n  apply(parser) {\n    const options = this.options; // metadata //\n\n    const tapRequireExpression = (expression, getMembers) => {\n      parser.hooks.typeof.for(expression).tap(\"CommonJsPlugin\", toConstantDependency(parser, JSON.stringify(\"function\")));\n      parser.hooks.evaluateTypeof.for(expression).tap(\"CommonJsPlugin\", evaluateToString(\"function\"));\n      parser.hooks.evaluateIdentifier.for(expression).tap(\"CommonJsPlugin\", evaluateToIdentifier(expression, \"require\", getMembers, true));\n    };\n\n    tapRequireExpression(\"require\", () => []);\n    tapRequireExpression(\"require.resolve\", () => [\"resolve\"]);\n    tapRequireExpression(\"require.resolveWeak\", () => [\"resolveWeak\"]); // Weird stuff //\n\n    parser.hooks.assign.for(\"require\").tap(\"CommonJsPlugin\", expr => {\n      // to not leak to global \"require\", we need to define a local require here.\n      const dep = new ConstDependency(\"var require;\", 0);\n      dep.loc = expr.loc;\n      parser.state.module.addPresentationalDependency(dep);\n      return true;\n    }); // Unsupported //\n\n    parser.hooks.expression.for(\"require.main.require\").tap(\"CommonJsPlugin\", expressionIsUnsupported(parser, \"require.main.require is not supported by webpack.\"));\n    parser.hooks.call.for(\"require.main.require\").tap(\"CommonJsPlugin\", expressionIsUnsupported(parser, \"require.main.require is not supported by webpack.\"));\n    parser.hooks.expression.for(\"module.parent.require\").tap(\"CommonJsPlugin\", expressionIsUnsupported(parser, \"module.parent.require is not supported by webpack.\"));\n    parser.hooks.call.for(\"module.parent.require\").tap(\"CommonJsPlugin\", expressionIsUnsupported(parser, \"module.parent.require is not supported by webpack.\")); // renaming //\n\n    parser.hooks.canRename.for(\"require\").tap(\"CommonJsPlugin\", () => true);\n    parser.hooks.rename.for(\"require\").tap(\"CommonJsPlugin\", expr => {\n      // To avoid \"not defined\" error, replace the value with undefined\n      const dep = new ConstDependency(\"undefined\", expr.range);\n      dep.loc = expr.loc;\n      parser.state.module.addPresentationalDependency(dep);\n      return false;\n    }); // inspection //\n\n    parser.hooks.expression.for(\"require.cache\").tap(\"CommonJsImportsParserPlugin\", toConstantDependency(parser, RuntimeGlobals.moduleCache, [RuntimeGlobals.moduleCache, RuntimeGlobals.moduleId, RuntimeGlobals.moduleLoaded])); // require as expression //\n\n    parser.hooks.expression.for(\"require\").tap(\"CommonJsImportsParserPlugin\", expr => {\n      const dep = new CommonJsRequireContextDependency({\n        request: options.unknownContextRequest,\n        recursive: options.unknownContextRecursive,\n        regExp: options.unknownContextRegExp,\n        mode: \"sync\"\n      }, expr.range, undefined, parser.scope.inShorthand);\n      dep.critical = options.unknownContextCritical && \"require function is used in a way in which dependencies cannot be statically extracted\";\n      dep.loc = expr.loc;\n      dep.optional = !!parser.scope.inTry;\n      parser.state.current.addDependency(dep);\n      return true;\n    }); // require //\n\n    const processRequireItem = (expr, param) => {\n      if (param.isString()) {\n        const dep = new CommonJsRequireDependency(param.string, param.range);\n        dep.loc = expr.loc;\n        dep.optional = !!parser.scope.inTry;\n        parser.state.current.addDependency(dep);\n        return true;\n      }\n    };\n\n    const processRequireContext = (expr, param) => {\n      const dep = ContextDependencyHelpers.create(CommonJsRequireContextDependency, expr.range, param, expr, options, {\n        category: \"commonjs\"\n      }, parser);\n      if (!dep) return;\n      dep.loc = expr.loc;\n      dep.optional = !!parser.scope.inTry;\n      parser.state.current.addDependency(dep);\n      return true;\n    };\n\n    const createRequireHandler = callNew => expr => {\n      if (options.commonjsMagicComments) {\n        const {\n          options: requireOptions,\n          errors: commentErrors\n        } = parser.parseCommentOptions(expr.range);\n\n        if (commentErrors) {\n          for (const e of commentErrors) {\n            const {\n              comment\n            } = e;\n            parser.state.module.addWarning(new CommentCompilationWarning(`Compilation error while processing magic comment(-s): /*${comment.value}*/: ${e.message}`, comment.loc));\n          }\n        }\n\n        if (requireOptions) {\n          if (requireOptions.webpackIgnore !== undefined) {\n            if (typeof requireOptions.webpackIgnore !== \"boolean\") {\n              parser.state.module.addWarning(new UnsupportedFeatureWarning(`\\`webpackIgnore\\` expected a boolean, but received: ${requireOptions.webpackIgnore}.`, expr.loc));\n            } else {\n              // Do not instrument `require()` if `webpackIgnore` is `true`\n              if (requireOptions.webpackIgnore) {\n                return true;\n              }\n            }\n          }\n        }\n      }\n\n      if (expr.arguments.length !== 1) return;\n      let localModule;\n      const param = parser.evaluateExpression(expr.arguments[0]);\n\n      if (param.isConditional()) {\n        let isExpression = false;\n\n        for (const p of param.options) {\n          const result = processRequireItem(expr, p);\n\n          if (result === undefined) {\n            isExpression = true;\n          }\n        }\n\n        if (!isExpression) {\n          const dep = new RequireHeaderDependency(expr.callee.range);\n          dep.loc = expr.loc;\n          parser.state.module.addPresentationalDependency(dep);\n          return true;\n        }\n      }\n\n      if (param.isString() && (localModule = getLocalModule(parser.state, param.string))) {\n        localModule.flagUsed();\n        const dep = new LocalModuleDependency(localModule, expr.range, callNew);\n        dep.loc = expr.loc;\n        parser.state.module.addPresentationalDependency(dep);\n        return true;\n      } else {\n        const result = processRequireItem(expr, param);\n\n        if (result === undefined) {\n          processRequireContext(expr, param);\n        } else {\n          const dep = new RequireHeaderDependency(expr.callee.range);\n          dep.loc = expr.loc;\n          parser.state.module.addPresentationalDependency(dep);\n        }\n\n        return true;\n      }\n    };\n\n    parser.hooks.call.for(\"require\").tap(\"CommonJsImportsParserPlugin\", createRequireHandler(false));\n    parser.hooks.new.for(\"require\").tap(\"CommonJsImportsParserPlugin\", createRequireHandler(true));\n    parser.hooks.call.for(\"module.require\").tap(\"CommonJsImportsParserPlugin\", createRequireHandler(false));\n    parser.hooks.new.for(\"module.require\").tap(\"CommonJsImportsParserPlugin\", createRequireHandler(true)); // require with property access //\n\n    const chainHandler = (expr, calleeMembers, callExpr, members) => {\n      if (callExpr.arguments.length !== 1) return;\n      const param = parser.evaluateExpression(callExpr.arguments[0]);\n\n      if (param.isString() && !getLocalModule(parser.state, param.string)) {\n        const dep = new CommonJsFullRequireDependency(param.string, expr.range, members);\n        dep.asiSafe = !parser.isAsiPosition(expr.range[0]);\n        dep.optional = !!parser.scope.inTry;\n        dep.loc = expr.loc;\n        parser.state.current.addDependency(dep);\n        return true;\n      }\n    };\n\n    const callChainHandler = (expr, calleeMembers, callExpr, members) => {\n      if (callExpr.arguments.length !== 1) return;\n      const param = parser.evaluateExpression(callExpr.arguments[0]);\n\n      if (param.isString() && !getLocalModule(parser.state, param.string)) {\n        const dep = new CommonJsFullRequireDependency(param.string, expr.callee.range, members);\n        dep.call = true;\n        dep.asiSafe = !parser.isAsiPosition(expr.range[0]);\n        dep.optional = !!parser.scope.inTry;\n        dep.loc = expr.callee.loc;\n        parser.state.current.addDependency(dep);\n        parser.walkExpressions(expr.arguments);\n        return true;\n      }\n    };\n\n    parser.hooks.memberChainOfCallMemberChain.for(\"require\").tap(\"CommonJsImportsParserPlugin\", chainHandler);\n    parser.hooks.memberChainOfCallMemberChain.for(\"module.require\").tap(\"CommonJsImportsParserPlugin\", chainHandler);\n    parser.hooks.callMemberChainOfCallMemberChain.for(\"require\").tap(\"CommonJsImportsParserPlugin\", callChainHandler);\n    parser.hooks.callMemberChainOfCallMemberChain.for(\"module.require\").tap(\"CommonJsImportsParserPlugin\", callChainHandler); // require.resolve //\n\n    const processResolve = (expr, weak) => {\n      if (expr.arguments.length !== 1) return;\n      const param = parser.evaluateExpression(expr.arguments[0]);\n\n      if (param.isConditional()) {\n        for (const option of param.options) {\n          const result = processResolveItem(expr, option, weak);\n\n          if (result === undefined) {\n            processResolveContext(expr, option, weak);\n          }\n        }\n\n        const dep = new RequireResolveHeaderDependency(expr.callee.range);\n        dep.loc = expr.loc;\n        parser.state.module.addPresentationalDependency(dep);\n        return true;\n      } else {\n        const result = processResolveItem(expr, param, weak);\n\n        if (result === undefined) {\n          processResolveContext(expr, param, weak);\n        }\n\n        const dep = new RequireResolveHeaderDependency(expr.callee.range);\n        dep.loc = expr.loc;\n        parser.state.module.addPresentationalDependency(dep);\n        return true;\n      }\n    };\n\n    const processResolveItem = (expr, param, weak) => {\n      if (param.isString()) {\n        const dep = new RequireResolveDependency(param.string, param.range);\n        dep.loc = expr.loc;\n        dep.optional = !!parser.scope.inTry;\n        dep.weak = weak;\n        parser.state.current.addDependency(dep);\n        return true;\n      }\n    };\n\n    const processResolveContext = (expr, param, weak) => {\n      const dep = ContextDependencyHelpers.create(RequireResolveContextDependency, param.range, param, expr, options, {\n        category: \"commonjs\",\n        mode: weak ? \"weak\" : \"sync\"\n      }, parser);\n      if (!dep) return;\n      dep.loc = expr.loc;\n      dep.optional = !!parser.scope.inTry;\n      parser.state.current.addDependency(dep);\n      return true;\n    };\n\n    parser.hooks.call.for(\"require.resolve\").tap(\"RequireResolveDependencyParserPlugin\", expr => {\n      return processResolve(expr, false);\n    });\n    parser.hooks.call.for(\"require.resolveWeak\").tap(\"RequireResolveDependencyParserPlugin\", expr => {\n      return processResolve(expr, true);\n    });\n  }\n\n}\n\nmodule.exports = CommonJsImportsParserPlugin;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/dependencies/CommonJsImportsParserPlugin.js"],"names":["CommentCompilationWarning","require","RuntimeGlobals","UnsupportedFeatureWarning","evaluateToIdentifier","evaluateToString","expressionIsUnsupported","toConstantDependency","CommonJsFullRequireDependency","CommonJsRequireContextDependency","CommonJsRequireDependency","ConstDependency","ContextDependencyHelpers","LocalModuleDependency","getLocalModule","RequireHeaderDependency","RequireResolveContextDependency","RequireResolveDependency","RequireResolveHeaderDependency","CommonJsImportsParserPlugin","constructor","options","apply","parser","tapRequireExpression","expression","getMembers","hooks","typeof","for","tap","JSON","stringify","evaluateTypeof","evaluateIdentifier","assign","expr","dep","loc","state","module","addPresentationalDependency","call","canRename","rename","range","moduleCache","moduleId","moduleLoaded","request","unknownContextRequest","recursive","unknownContextRecursive","regExp","unknownContextRegExp","mode","undefined","scope","inShorthand","critical","unknownContextCritical","optional","inTry","current","addDependency","processRequireItem","param","isString","string","processRequireContext","create","category","createRequireHandler","callNew","commonjsMagicComments","requireOptions","errors","commentErrors","parseCommentOptions","e","comment","addWarning","value","message","webpackIgnore","arguments","length","localModule","evaluateExpression","isConditional","isExpression","p","result","callee","flagUsed","new","chainHandler","calleeMembers","callExpr","members","asiSafe","isAsiPosition","callChainHandler","walkExpressions","memberChainOfCallMemberChain","callMemberChainOfCallMemberChain","processResolve","weak","option","processResolveItem","processResolveContext","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst CommentCompilationWarning = require(\"../CommentCompilationWarning\");\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\nconst UnsupportedFeatureWarning = require(\"../UnsupportedFeatureWarning\");\nconst {\n\tevaluateToIdentifier,\n\tevaluateToString,\n\texpressionIsUnsupported,\n\ttoConstantDependency\n} = require(\"../javascript/JavascriptParserHelpers\");\nconst CommonJsFullRequireDependency = require(\"./CommonJsFullRequireDependency\");\nconst CommonJsRequireContextDependency = require(\"./CommonJsRequireContextDependency\");\nconst CommonJsRequireDependency = require(\"./CommonJsRequireDependency\");\nconst ConstDependency = require(\"./ConstDependency\");\nconst ContextDependencyHelpers = require(\"./ContextDependencyHelpers\");\nconst LocalModuleDependency = require(\"./LocalModuleDependency\");\nconst { getLocalModule } = require(\"./LocalModulesHelpers\");\nconst RequireHeaderDependency = require(\"./RequireHeaderDependency\");\nconst RequireResolveContextDependency = require(\"./RequireResolveContextDependency\");\nconst RequireResolveDependency = require(\"./RequireResolveDependency\");\nconst RequireResolveHeaderDependency = require(\"./RequireResolveHeaderDependency\");\n\n/** @typedef {import(\"../../declarations/WebpackOptions\").JavascriptParserOptions} JavascriptParserOptions */\n\nclass CommonJsImportsParserPlugin {\n\t/**\n\t * @param {JavascriptParserOptions} options parser options\n\t */\n\tconstructor(options) {\n\t\tthis.options = options;\n\t}\n\n\tapply(parser) {\n\t\tconst options = this.options;\n\n\t\t// metadata //\n\t\tconst tapRequireExpression = (expression, getMembers) => {\n\t\t\tparser.hooks.typeof\n\t\t\t\t.for(expression)\n\t\t\t\t.tap(\n\t\t\t\t\t\"CommonJsPlugin\",\n\t\t\t\t\ttoConstantDependency(parser, JSON.stringify(\"function\"))\n\t\t\t\t);\n\t\t\tparser.hooks.evaluateTypeof\n\t\t\t\t.for(expression)\n\t\t\t\t.tap(\"CommonJsPlugin\", evaluateToString(\"function\"));\n\t\t\tparser.hooks.evaluateIdentifier\n\t\t\t\t.for(expression)\n\t\t\t\t.tap(\n\t\t\t\t\t\"CommonJsPlugin\",\n\t\t\t\t\tevaluateToIdentifier(expression, \"require\", getMembers, true)\n\t\t\t\t);\n\t\t};\n\t\ttapRequireExpression(\"require\", () => []);\n\t\ttapRequireExpression(\"require.resolve\", () => [\"resolve\"]);\n\t\ttapRequireExpression(\"require.resolveWeak\", () => [\"resolveWeak\"]);\n\n\t\t// Weird stuff //\n\t\tparser.hooks.assign.for(\"require\").tap(\"CommonJsPlugin\", expr => {\n\t\t\t// to not leak to global \"require\", we need to define a local require here.\n\t\t\tconst dep = new ConstDependency(\"var require;\", 0);\n\t\t\tdep.loc = expr.loc;\n\t\t\tparser.state.module.addPresentationalDependency(dep);\n\t\t\treturn true;\n\t\t});\n\n\t\t// Unsupported //\n\t\tparser.hooks.expression\n\t\t\t.for(\"require.main.require\")\n\t\t\t.tap(\n\t\t\t\t\"CommonJsPlugin\",\n\t\t\t\texpressionIsUnsupported(\n\t\t\t\t\tparser,\n\t\t\t\t\t\"require.main.require is not supported by webpack.\"\n\t\t\t\t)\n\t\t\t);\n\t\tparser.hooks.call\n\t\t\t.for(\"require.main.require\")\n\t\t\t.tap(\n\t\t\t\t\"CommonJsPlugin\",\n\t\t\t\texpressionIsUnsupported(\n\t\t\t\t\tparser,\n\t\t\t\t\t\"require.main.require is not supported by webpack.\"\n\t\t\t\t)\n\t\t\t);\n\t\tparser.hooks.expression\n\t\t\t.for(\"module.parent.require\")\n\t\t\t.tap(\n\t\t\t\t\"CommonJsPlugin\",\n\t\t\t\texpressionIsUnsupported(\n\t\t\t\t\tparser,\n\t\t\t\t\t\"module.parent.require is not supported by webpack.\"\n\t\t\t\t)\n\t\t\t);\n\t\tparser.hooks.call\n\t\t\t.for(\"module.parent.require\")\n\t\t\t.tap(\n\t\t\t\t\"CommonJsPlugin\",\n\t\t\t\texpressionIsUnsupported(\n\t\t\t\t\tparser,\n\t\t\t\t\t\"module.parent.require is not supported by webpack.\"\n\t\t\t\t)\n\t\t\t);\n\n\t\t// renaming //\n\t\tparser.hooks.canRename.for(\"require\").tap(\"CommonJsPlugin\", () => true);\n\t\tparser.hooks.rename.for(\"require\").tap(\"CommonJsPlugin\", expr => {\n\t\t\t// To avoid \"not defined\" error, replace the value with undefined\n\t\t\tconst dep = new ConstDependency(\"undefined\", expr.range);\n\t\t\tdep.loc = expr.loc;\n\t\t\tparser.state.module.addPresentationalDependency(dep);\n\t\t\treturn false;\n\t\t});\n\n\t\t// inspection //\n\t\tparser.hooks.expression\n\t\t\t.for(\"require.cache\")\n\t\t\t.tap(\n\t\t\t\t\"CommonJsImportsParserPlugin\",\n\t\t\t\ttoConstantDependency(parser, RuntimeGlobals.moduleCache, [\n\t\t\t\t\tRuntimeGlobals.moduleCache,\n\t\t\t\t\tRuntimeGlobals.moduleId,\n\t\t\t\t\tRuntimeGlobals.moduleLoaded\n\t\t\t\t])\n\t\t\t);\n\n\t\t// require as expression //\n\t\tparser.hooks.expression\n\t\t\t.for(\"require\")\n\t\t\t.tap(\"CommonJsImportsParserPlugin\", expr => {\n\t\t\t\tconst dep = new CommonJsRequireContextDependency(\n\t\t\t\t\t{\n\t\t\t\t\t\trequest: options.unknownContextRequest,\n\t\t\t\t\t\trecursive: options.unknownContextRecursive,\n\t\t\t\t\t\tregExp: options.unknownContextRegExp,\n\t\t\t\t\t\tmode: \"sync\"\n\t\t\t\t\t},\n\t\t\t\t\texpr.range,\n\t\t\t\t\tundefined,\n\t\t\t\t\tparser.scope.inShorthand\n\t\t\t\t);\n\t\t\t\tdep.critical =\n\t\t\t\t\toptions.unknownContextCritical &&\n\t\t\t\t\t\"require function is used in a way in which dependencies cannot be statically extracted\";\n\t\t\t\tdep.loc = expr.loc;\n\t\t\t\tdep.optional = !!parser.scope.inTry;\n\t\t\t\tparser.state.current.addDependency(dep);\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t// require //\n\t\tconst processRequireItem = (expr, param) => {\n\t\t\tif (param.isString()) {\n\t\t\t\tconst dep = new CommonJsRequireDependency(param.string, param.range);\n\t\t\t\tdep.loc = expr.loc;\n\t\t\t\tdep.optional = !!parser.scope.inTry;\n\t\t\t\tparser.state.current.addDependency(dep);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t\tconst processRequireContext = (expr, param) => {\n\t\t\tconst dep = ContextDependencyHelpers.create(\n\t\t\t\tCommonJsRequireContextDependency,\n\t\t\t\texpr.range,\n\t\t\t\tparam,\n\t\t\t\texpr,\n\t\t\t\toptions,\n\t\t\t\t{\n\t\t\t\t\tcategory: \"commonjs\"\n\t\t\t\t},\n\t\t\t\tparser\n\t\t\t);\n\t\t\tif (!dep) return;\n\t\t\tdep.loc = expr.loc;\n\t\t\tdep.optional = !!parser.scope.inTry;\n\t\t\tparser.state.current.addDependency(dep);\n\t\t\treturn true;\n\t\t};\n\t\tconst createRequireHandler = callNew => expr => {\n\t\t\tif (options.commonjsMagicComments) {\n\t\t\t\tconst { options: requireOptions, errors: commentErrors } =\n\t\t\t\t\tparser.parseCommentOptions(expr.range);\n\n\t\t\t\tif (commentErrors) {\n\t\t\t\t\tfor (const e of commentErrors) {\n\t\t\t\t\t\tconst { comment } = e;\n\t\t\t\t\t\tparser.state.module.addWarning(\n\t\t\t\t\t\t\tnew CommentCompilationWarning(\n\t\t\t\t\t\t\t\t`Compilation error while processing magic comment(-s): /*${comment.value}*/: ${e.message}`,\n\t\t\t\t\t\t\t\tcomment.loc\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (requireOptions) {\n\t\t\t\t\tif (requireOptions.webpackIgnore !== undefined) {\n\t\t\t\t\t\tif (typeof requireOptions.webpackIgnore !== \"boolean\") {\n\t\t\t\t\t\t\tparser.state.module.addWarning(\n\t\t\t\t\t\t\t\tnew UnsupportedFeatureWarning(\n\t\t\t\t\t\t\t\t\t`\\`webpackIgnore\\` expected a boolean, but received: ${requireOptions.webpackIgnore}.`,\n\t\t\t\t\t\t\t\t\texpr.loc\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Do not instrument `require()` if `webpackIgnore` is `true`\n\t\t\t\t\t\t\tif (requireOptions.webpackIgnore) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (expr.arguments.length !== 1) return;\n\t\t\tlet localModule;\n\t\t\tconst param = parser.evaluateExpression(expr.arguments[0]);\n\t\t\tif (param.isConditional()) {\n\t\t\t\tlet isExpression = false;\n\t\t\t\tfor (const p of param.options) {\n\t\t\t\t\tconst result = processRequireItem(expr, p);\n\t\t\t\t\tif (result === undefined) {\n\t\t\t\t\t\tisExpression = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!isExpression) {\n\t\t\t\t\tconst dep = new RequireHeaderDependency(expr.callee.range);\n\t\t\t\t\tdep.loc = expr.loc;\n\t\t\t\t\tparser.state.module.addPresentationalDependency(dep);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (\n\t\t\t\tparam.isString() &&\n\t\t\t\t(localModule = getLocalModule(parser.state, param.string))\n\t\t\t) {\n\t\t\t\tlocalModule.flagUsed();\n\t\t\t\tconst dep = new LocalModuleDependency(localModule, expr.range, callNew);\n\t\t\t\tdep.loc = expr.loc;\n\t\t\t\tparser.state.module.addPresentationalDependency(dep);\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tconst result = processRequireItem(expr, param);\n\t\t\t\tif (result === undefined) {\n\t\t\t\t\tprocessRequireContext(expr, param);\n\t\t\t\t} else {\n\t\t\t\t\tconst dep = new RequireHeaderDependency(expr.callee.range);\n\t\t\t\t\tdep.loc = expr.loc;\n\t\t\t\t\tparser.state.module.addPresentationalDependency(dep);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t\tparser.hooks.call\n\t\t\t.for(\"require\")\n\t\t\t.tap(\"CommonJsImportsParserPlugin\", createRequireHandler(false));\n\t\tparser.hooks.new\n\t\t\t.for(\"require\")\n\t\t\t.tap(\"CommonJsImportsParserPlugin\", createRequireHandler(true));\n\t\tparser.hooks.call\n\t\t\t.for(\"module.require\")\n\t\t\t.tap(\"CommonJsImportsParserPlugin\", createRequireHandler(false));\n\t\tparser.hooks.new\n\t\t\t.for(\"module.require\")\n\t\t\t.tap(\"CommonJsImportsParserPlugin\", createRequireHandler(true));\n\n\t\t// require with property access //\n\t\tconst chainHandler = (expr, calleeMembers, callExpr, members) => {\n\t\t\tif (callExpr.arguments.length !== 1) return;\n\t\t\tconst param = parser.evaluateExpression(callExpr.arguments[0]);\n\t\t\tif (param.isString() && !getLocalModule(parser.state, param.string)) {\n\t\t\t\tconst dep = new CommonJsFullRequireDependency(\n\t\t\t\t\tparam.string,\n\t\t\t\t\texpr.range,\n\t\t\t\t\tmembers\n\t\t\t\t);\n\t\t\t\tdep.asiSafe = !parser.isAsiPosition(expr.range[0]);\n\t\t\t\tdep.optional = !!parser.scope.inTry;\n\t\t\t\tdep.loc = expr.loc;\n\t\t\t\tparser.state.current.addDependency(dep);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t\tconst callChainHandler = (expr, calleeMembers, callExpr, members) => {\n\t\t\tif (callExpr.arguments.length !== 1) return;\n\t\t\tconst param = parser.evaluateExpression(callExpr.arguments[0]);\n\t\t\tif (param.isString() && !getLocalModule(parser.state, param.string)) {\n\t\t\t\tconst dep = new CommonJsFullRequireDependency(\n\t\t\t\t\tparam.string,\n\t\t\t\t\texpr.callee.range,\n\t\t\t\t\tmembers\n\t\t\t\t);\n\t\t\t\tdep.call = true;\n\t\t\t\tdep.asiSafe = !parser.isAsiPosition(expr.range[0]);\n\t\t\t\tdep.optional = !!parser.scope.inTry;\n\t\t\t\tdep.loc = expr.callee.loc;\n\t\t\t\tparser.state.current.addDependency(dep);\n\t\t\t\tparser.walkExpressions(expr.arguments);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t\tparser.hooks.memberChainOfCallMemberChain\n\t\t\t.for(\"require\")\n\t\t\t.tap(\"CommonJsImportsParserPlugin\", chainHandler);\n\t\tparser.hooks.memberChainOfCallMemberChain\n\t\t\t.for(\"module.require\")\n\t\t\t.tap(\"CommonJsImportsParserPlugin\", chainHandler);\n\t\tparser.hooks.callMemberChainOfCallMemberChain\n\t\t\t.for(\"require\")\n\t\t\t.tap(\"CommonJsImportsParserPlugin\", callChainHandler);\n\t\tparser.hooks.callMemberChainOfCallMemberChain\n\t\t\t.for(\"module.require\")\n\t\t\t.tap(\"CommonJsImportsParserPlugin\", callChainHandler);\n\n\t\t// require.resolve //\n\t\tconst processResolve = (expr, weak) => {\n\t\t\tif (expr.arguments.length !== 1) return;\n\t\t\tconst param = parser.evaluateExpression(expr.arguments[0]);\n\t\t\tif (param.isConditional()) {\n\t\t\t\tfor (const option of param.options) {\n\t\t\t\t\tconst result = processResolveItem(expr, option, weak);\n\t\t\t\t\tif (result === undefined) {\n\t\t\t\t\t\tprocessResolveContext(expr, option, weak);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst dep = new RequireResolveHeaderDependency(expr.callee.range);\n\t\t\t\tdep.loc = expr.loc;\n\t\t\t\tparser.state.module.addPresentationalDependency(dep);\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tconst result = processResolveItem(expr, param, weak);\n\t\t\t\tif (result === undefined) {\n\t\t\t\t\tprocessResolveContext(expr, param, weak);\n\t\t\t\t}\n\t\t\t\tconst dep = new RequireResolveHeaderDependency(expr.callee.range);\n\t\t\t\tdep.loc = expr.loc;\n\t\t\t\tparser.state.module.addPresentationalDependency(dep);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t\tconst processResolveItem = (expr, param, weak) => {\n\t\t\tif (param.isString()) {\n\t\t\t\tconst dep = new RequireResolveDependency(param.string, param.range);\n\t\t\t\tdep.loc = expr.loc;\n\t\t\t\tdep.optional = !!parser.scope.inTry;\n\t\t\t\tdep.weak = weak;\n\t\t\t\tparser.state.current.addDependency(dep);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t\tconst processResolveContext = (expr, param, weak) => {\n\t\t\tconst dep = ContextDependencyHelpers.create(\n\t\t\t\tRequireResolveContextDependency,\n\t\t\t\tparam.range,\n\t\t\t\tparam,\n\t\t\t\texpr,\n\t\t\t\toptions,\n\t\t\t\t{\n\t\t\t\t\tcategory: \"commonjs\",\n\t\t\t\t\tmode: weak ? \"weak\" : \"sync\"\n\t\t\t\t},\n\t\t\t\tparser\n\t\t\t);\n\t\t\tif (!dep) return;\n\t\t\tdep.loc = expr.loc;\n\t\t\tdep.optional = !!parser.scope.inTry;\n\t\t\tparser.state.current.addDependency(dep);\n\t\t\treturn true;\n\t\t};\n\n\t\tparser.hooks.call\n\t\t\t.for(\"require.resolve\")\n\t\t\t.tap(\"RequireResolveDependencyParserPlugin\", expr => {\n\t\t\t\treturn processResolve(expr, false);\n\t\t\t});\n\t\tparser.hooks.call\n\t\t\t.for(\"require.resolveWeak\")\n\t\t\t.tap(\"RequireResolveDependencyParserPlugin\", expr => {\n\t\t\t\treturn processResolve(expr, true);\n\t\t\t});\n\t}\n}\nmodule.exports = CommonJsImportsParserPlugin;\n"]},"metadata":{},"sourceType":"script"}