{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst {\n  AsyncParallelHook,\n  AsyncSeriesBailHook,\n  SyncHook\n} = require(\"tapable\");\n\nconst {\n  makeWebpackError,\n  makeWebpackErrorCallback\n} = require(\"./HookWebpackError\");\n/** @typedef {import(\"./WebpackError\")} WebpackError */\n\n/**\n * @typedef {Object} Etag\n * @property {function(): string} toString\n */\n\n/**\n * @template T\n * @callback CallbackCache\n * @param {(WebpackError | null)=} err\n * @param {T=} result\n * @returns {void}\n */\n\n/**\n * @callback GotHandler\n * @param {any} result\n * @param {function(Error=): void} callback\n * @returns {void}\n */\n\n\nconst needCalls = (times, callback) => {\n  return err => {\n    if (--times === 0) {\n      return callback(err);\n    }\n\n    if (err && times > 0) {\n      times = 0;\n      return callback(err);\n    }\n  };\n};\n\nclass Cache {\n  constructor() {\n    this.hooks = {\n      /** @type {AsyncSeriesBailHook<[string, Etag | null, GotHandler[]], any>} */\n      get: new AsyncSeriesBailHook([\"identifier\", \"etag\", \"gotHandlers\"]),\n\n      /** @type {AsyncParallelHook<[string, Etag | null, any]>} */\n      store: new AsyncParallelHook([\"identifier\", \"etag\", \"data\"]),\n\n      /** @type {AsyncParallelHook<[Iterable<string>]>} */\n      storeBuildDependencies: new AsyncParallelHook([\"dependencies\"]),\n\n      /** @type {SyncHook<[]>} */\n      beginIdle: new SyncHook([]),\n\n      /** @type {AsyncParallelHook<[]>} */\n      endIdle: new AsyncParallelHook([]),\n\n      /** @type {AsyncParallelHook<[]>} */\n      shutdown: new AsyncParallelHook([])\n    };\n  }\n  /**\n   * @template T\n   * @param {string} identifier the cache identifier\n   * @param {Etag | null} etag the etag\n   * @param {CallbackCache<T>} callback signals when the value is retrieved\n   * @returns {void}\n   */\n\n\n  get(identifier, etag, callback) {\n    const gotHandlers = [];\n    this.hooks.get.callAsync(identifier, etag, gotHandlers, (err, result) => {\n      if (err) {\n        callback(makeWebpackError(err, \"Cache.hooks.get\"));\n        return;\n      }\n\n      if (result === null) {\n        result = undefined;\n      }\n\n      if (gotHandlers.length > 1) {\n        const innerCallback = needCalls(gotHandlers.length, () => callback(null, result));\n\n        for (const gotHandler of gotHandlers) {\n          gotHandler(result, innerCallback);\n        }\n      } else if (gotHandlers.length === 1) {\n        gotHandlers[0](result, () => callback(null, result));\n      } else {\n        callback(null, result);\n      }\n    });\n  }\n  /**\n   * @template T\n   * @param {string} identifier the cache identifier\n   * @param {Etag | null} etag the etag\n   * @param {T} data the value to store\n   * @param {CallbackCache<void>} callback signals when the value is stored\n   * @returns {void}\n   */\n\n\n  store(identifier, etag, data, callback) {\n    this.hooks.store.callAsync(identifier, etag, data, makeWebpackErrorCallback(callback, \"Cache.hooks.store\"));\n  }\n  /**\n   * After this method has succeeded the cache can only be restored when build dependencies are\n   * @param {Iterable<string>} dependencies list of all build dependencies\n   * @param {CallbackCache<void>} callback signals when the dependencies are stored\n   * @returns {void}\n   */\n\n\n  storeBuildDependencies(dependencies, callback) {\n    this.hooks.storeBuildDependencies.callAsync(dependencies, makeWebpackErrorCallback(callback, \"Cache.hooks.storeBuildDependencies\"));\n  }\n  /**\n   * @returns {void}\n   */\n\n\n  beginIdle() {\n    this.hooks.beginIdle.call();\n  }\n  /**\n   * @param {CallbackCache<void>} callback signals when the call finishes\n   * @returns {void}\n   */\n\n\n  endIdle(callback) {\n    this.hooks.endIdle.callAsync(makeWebpackErrorCallback(callback, \"Cache.hooks.endIdle\"));\n  }\n  /**\n   * @param {CallbackCache<void>} callback signals when the call finishes\n   * @returns {void}\n   */\n\n\n  shutdown(callback) {\n    this.hooks.shutdown.callAsync(makeWebpackErrorCallback(callback, \"Cache.hooks.shutdown\"));\n  }\n\n}\n\nCache.STAGE_MEMORY = -10;\nCache.STAGE_DEFAULT = 0;\nCache.STAGE_DISK = 10;\nCache.STAGE_NETWORK = 20;\nmodule.exports = Cache;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/Cache.js"],"names":["AsyncParallelHook","AsyncSeriesBailHook","SyncHook","require","makeWebpackError","makeWebpackErrorCallback","needCalls","times","callback","err","Cache","constructor","hooks","get","store","storeBuildDependencies","beginIdle","endIdle","shutdown","identifier","etag","gotHandlers","callAsync","result","undefined","length","innerCallback","gotHandler","data","dependencies","call","STAGE_MEMORY","STAGE_DEFAULT","STAGE_DISK","STAGE_NETWORK","module","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst { AsyncParallelHook, AsyncSeriesBailHook, SyncHook } = require(\"tapable\");\nconst {\n\tmakeWebpackError,\n\tmakeWebpackErrorCallback\n} = require(\"./HookWebpackError\");\n\n/** @typedef {import(\"./WebpackError\")} WebpackError */\n\n/**\n * @typedef {Object} Etag\n * @property {function(): string} toString\n */\n\n/**\n * @template T\n * @callback CallbackCache\n * @param {(WebpackError | null)=} err\n * @param {T=} result\n * @returns {void}\n */\n\n/**\n * @callback GotHandler\n * @param {any} result\n * @param {function(Error=): void} callback\n * @returns {void}\n */\n\nconst needCalls = (times, callback) => {\n\treturn err => {\n\t\tif (--times === 0) {\n\t\t\treturn callback(err);\n\t\t}\n\t\tif (err && times > 0) {\n\t\t\ttimes = 0;\n\t\t\treturn callback(err);\n\t\t}\n\t};\n};\n\nclass Cache {\n\tconstructor() {\n\t\tthis.hooks = {\n\t\t\t/** @type {AsyncSeriesBailHook<[string, Etag | null, GotHandler[]], any>} */\n\t\t\tget: new AsyncSeriesBailHook([\"identifier\", \"etag\", \"gotHandlers\"]),\n\t\t\t/** @type {AsyncParallelHook<[string, Etag | null, any]>} */\n\t\t\tstore: new AsyncParallelHook([\"identifier\", \"etag\", \"data\"]),\n\t\t\t/** @type {AsyncParallelHook<[Iterable<string>]>} */\n\t\t\tstoreBuildDependencies: new AsyncParallelHook([\"dependencies\"]),\n\t\t\t/** @type {SyncHook<[]>} */\n\t\t\tbeginIdle: new SyncHook([]),\n\t\t\t/** @type {AsyncParallelHook<[]>} */\n\t\t\tendIdle: new AsyncParallelHook([]),\n\t\t\t/** @type {AsyncParallelHook<[]>} */\n\t\t\tshutdown: new AsyncParallelHook([])\n\t\t};\n\t}\n\n\t/**\n\t * @template T\n\t * @param {string} identifier the cache identifier\n\t * @param {Etag | null} etag the etag\n\t * @param {CallbackCache<T>} callback signals when the value is retrieved\n\t * @returns {void}\n\t */\n\tget(identifier, etag, callback) {\n\t\tconst gotHandlers = [];\n\t\tthis.hooks.get.callAsync(identifier, etag, gotHandlers, (err, result) => {\n\t\t\tif (err) {\n\t\t\t\tcallback(makeWebpackError(err, \"Cache.hooks.get\"));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (result === null) {\n\t\t\t\tresult = undefined;\n\t\t\t}\n\t\t\tif (gotHandlers.length > 1) {\n\t\t\t\tconst innerCallback = needCalls(gotHandlers.length, () =>\n\t\t\t\t\tcallback(null, result)\n\t\t\t\t);\n\t\t\t\tfor (const gotHandler of gotHandlers) {\n\t\t\t\t\tgotHandler(result, innerCallback);\n\t\t\t\t}\n\t\t\t} else if (gotHandlers.length === 1) {\n\t\t\t\tgotHandlers[0](result, () => callback(null, result));\n\t\t\t} else {\n\t\t\t\tcallback(null, result);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * @template T\n\t * @param {string} identifier the cache identifier\n\t * @param {Etag | null} etag the etag\n\t * @param {T} data the value to store\n\t * @param {CallbackCache<void>} callback signals when the value is stored\n\t * @returns {void}\n\t */\n\tstore(identifier, etag, data, callback) {\n\t\tthis.hooks.store.callAsync(\n\t\t\tidentifier,\n\t\t\tetag,\n\t\t\tdata,\n\t\t\tmakeWebpackErrorCallback(callback, \"Cache.hooks.store\")\n\t\t);\n\t}\n\n\t/**\n\t * After this method has succeeded the cache can only be restored when build dependencies are\n\t * @param {Iterable<string>} dependencies list of all build dependencies\n\t * @param {CallbackCache<void>} callback signals when the dependencies are stored\n\t * @returns {void}\n\t */\n\tstoreBuildDependencies(dependencies, callback) {\n\t\tthis.hooks.storeBuildDependencies.callAsync(\n\t\t\tdependencies,\n\t\t\tmakeWebpackErrorCallback(callback, \"Cache.hooks.storeBuildDependencies\")\n\t\t);\n\t}\n\n\t/**\n\t * @returns {void}\n\t */\n\tbeginIdle() {\n\t\tthis.hooks.beginIdle.call();\n\t}\n\n\t/**\n\t * @param {CallbackCache<void>} callback signals when the call finishes\n\t * @returns {void}\n\t */\n\tendIdle(callback) {\n\t\tthis.hooks.endIdle.callAsync(\n\t\t\tmakeWebpackErrorCallback(callback, \"Cache.hooks.endIdle\")\n\t\t);\n\t}\n\n\t/**\n\t * @param {CallbackCache<void>} callback signals when the call finishes\n\t * @returns {void}\n\t */\n\tshutdown(callback) {\n\t\tthis.hooks.shutdown.callAsync(\n\t\t\tmakeWebpackErrorCallback(callback, \"Cache.hooks.shutdown\")\n\t\t);\n\t}\n}\n\nCache.STAGE_MEMORY = -10;\nCache.STAGE_DEFAULT = 0;\nCache.STAGE_DISK = 10;\nCache.STAGE_NETWORK = 20;\n\nmodule.exports = Cache;\n"]},"metadata":{},"sourceType":"script"}