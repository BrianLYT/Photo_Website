{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst {\n  RawSource\n} = require(\"webpack-sources\");\n\nconst AsyncDependenciesBlock = require(\"../AsyncDependenciesBlock\");\n\nconst Module = require(\"../Module\");\n\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\n\nconst makeSerializable = require(\"../util/makeSerializable\");\n\nconst {\n  rangeToString,\n  stringifyHoley\n} = require(\"../util/semver\");\n\nconst ConsumeSharedFallbackDependency = require(\"./ConsumeSharedFallbackDependency\");\n/** @typedef {import(\"../../declarations/WebpackOptions\").WebpackOptionsNormalized} WebpackOptions */\n\n/** @typedef {import(\"../ChunkGraph\")} ChunkGraph */\n\n/** @typedef {import(\"../ChunkGroup\")} ChunkGroup */\n\n/** @typedef {import(\"../Compilation\")} Compilation */\n\n/** @typedef {import(\"../Dependency\").UpdateHashContext} UpdateHashContext */\n\n/** @typedef {import(\"../Module\").CodeGenerationContext} CodeGenerationContext */\n\n/** @typedef {import(\"../Module\").CodeGenerationResult} CodeGenerationResult */\n\n/** @typedef {import(\"../Module\").LibIdentOptions} LibIdentOptions */\n\n/** @typedef {import(\"../Module\").NeedBuildContext} NeedBuildContext */\n\n/** @typedef {import(\"../RequestShortener\")} RequestShortener */\n\n/** @typedef {import(\"../ResolverFactory\").ResolverWithOptions} ResolverWithOptions */\n\n/** @typedef {import(\"../WebpackError\")} WebpackError */\n\n/** @typedef {import(\"../util/Hash\")} Hash */\n\n/** @typedef {import(\"../util/fs\").InputFileSystem} InputFileSystem */\n\n/** @typedef {import(\"../util/semver\").SemVerRange} SemVerRange */\n\n/**\n * @typedef {Object} ConsumeOptions\n * @property {string=} import fallback request\n * @property {string=} importResolved resolved fallback request\n * @property {string} shareKey global share key\n * @property {string} shareScope share scope\n * @property {SemVerRange | false | undefined} requiredVersion version requirement\n * @property {string} packageName package name to determine required version automatically\n * @property {boolean} strictVersion don't use shared version even if version isn't valid\n * @property {boolean} singleton use single global version\n * @property {boolean} eager include the fallback module in a sync way\n */\n\n\nconst TYPES = new Set([\"consume-shared\"]);\n\nclass ConsumeSharedModule extends Module {\n  /**\n   * @param {string} context context\n   * @param {ConsumeOptions} options consume options\n   */\n  constructor(context, options) {\n    super(\"consume-shared-module\", context);\n    this.options = options;\n  }\n  /**\n   * @returns {string} a unique identifier of the module\n   */\n\n\n  identifier() {\n    const {\n      shareKey,\n      shareScope,\n      importResolved,\n      requiredVersion,\n      strictVersion,\n      singleton,\n      eager\n    } = this.options;\n    return `consume-shared-module|${shareScope}|${shareKey}|${requiredVersion && rangeToString(requiredVersion)}|${strictVersion}|${importResolved}|${singleton}|${eager}`;\n  }\n  /**\n   * @param {RequestShortener} requestShortener the request shortener\n   * @returns {string} a user readable identifier of the module\n   */\n\n\n  readableIdentifier(requestShortener) {\n    const {\n      shareKey,\n      shareScope,\n      importResolved,\n      requiredVersion,\n      strictVersion,\n      singleton,\n      eager\n    } = this.options;\n    return `consume shared module (${shareScope}) ${shareKey}@${requiredVersion ? rangeToString(requiredVersion) : \"*\"}${strictVersion ? \" (strict)\" : \"\"}${singleton ? \" (singleton)\" : \"\"}${importResolved ? ` (fallback: ${requestShortener.shorten(importResolved)})` : \"\"}${eager ? \" (eager)\" : \"\"}`;\n  }\n  /**\n   * @param {LibIdentOptions} options options\n   * @returns {string | null} an identifier for library inclusion\n   */\n\n\n  libIdent(options) {\n    const {\n      shareKey,\n      shareScope,\n      import: request\n    } = this.options;\n    return `${this.layer ? `(${this.layer})/` : \"\"}webpack/sharing/consume/${shareScope}/${shareKey}${request ? `/${request}` : \"\"}`;\n  }\n  /**\n   * @param {NeedBuildContext} context context info\n   * @param {function((WebpackError | null)=, boolean=): void} callback callback function, returns true, if the module needs a rebuild\n   * @returns {void}\n   */\n\n\n  needBuild(context, callback) {\n    callback(null, !this.buildInfo);\n  }\n  /**\n   * @param {WebpackOptions} options webpack options\n   * @param {Compilation} compilation the compilation\n   * @param {ResolverWithOptions} resolver the resolver\n   * @param {InputFileSystem} fs the file system\n   * @param {function(WebpackError=): void} callback callback function\n   * @returns {void}\n   */\n\n\n  build(options, compilation, resolver, fs, callback) {\n    this.buildMeta = {};\n    this.buildInfo = {};\n\n    if (this.options.import) {\n      const dep = new ConsumeSharedFallbackDependency(this.options.import);\n\n      if (this.options.eager) {\n        this.addDependency(dep);\n      } else {\n        const block = new AsyncDependenciesBlock({});\n        block.addDependency(dep);\n        this.addBlock(block);\n      }\n    }\n\n    callback();\n  }\n  /**\n   * @returns {Set<string>} types available (do not mutate)\n   */\n\n\n  getSourceTypes() {\n    return TYPES;\n  }\n  /**\n   * @param {string=} type the source type for which the size should be estimated\n   * @returns {number} the estimated size of the module (must be non-zero)\n   */\n\n\n  size(type) {\n    return 42;\n  }\n  /**\n   * @param {Hash} hash the hash used to track dependencies\n   * @param {UpdateHashContext} context context\n   * @returns {void}\n   */\n\n\n  updateHash(hash, context) {\n    hash.update(JSON.stringify(this.options));\n    super.updateHash(hash, context);\n  }\n  /**\n   * @param {CodeGenerationContext} context context for code generation\n   * @returns {CodeGenerationResult} result\n   */\n\n\n  codeGeneration(_ref) {\n    let {\n      chunkGraph,\n      moduleGraph,\n      runtimeTemplate\n    } = _ref;\n    const runtimeRequirements = new Set([RuntimeGlobals.shareScopeMap]);\n    const {\n      shareScope,\n      shareKey,\n      strictVersion,\n      requiredVersion,\n      import: request,\n      singleton,\n      eager\n    } = this.options;\n    let fallbackCode;\n\n    if (request) {\n      if (eager) {\n        const dep = this.dependencies[0];\n        fallbackCode = runtimeTemplate.syncModuleFactory({\n          dependency: dep,\n          chunkGraph,\n          runtimeRequirements,\n          request: this.options.import\n        });\n      } else {\n        const block = this.blocks[0];\n        fallbackCode = runtimeTemplate.asyncModuleFactory({\n          block,\n          chunkGraph,\n          runtimeRequirements,\n          request: this.options.import\n        });\n      }\n    }\n\n    let fn = \"load\";\n    const args = [JSON.stringify(shareScope), JSON.stringify(shareKey)];\n\n    if (requiredVersion) {\n      if (strictVersion) {\n        fn += \"Strict\";\n      }\n\n      if (singleton) {\n        fn += \"Singleton\";\n      }\n\n      args.push(stringifyHoley(requiredVersion));\n      fn += \"VersionCheck\";\n    } else {\n      if (singleton) {\n        fn += \"Singleton\";\n      }\n    }\n\n    if (fallbackCode) {\n      fn += \"Fallback\";\n      args.push(fallbackCode);\n    }\n\n    const code = runtimeTemplate.returningFunction(`${fn}(${args.join(\", \")})`);\n    const sources = new Map();\n    sources.set(\"consume-shared\", new RawSource(code));\n    return {\n      runtimeRequirements,\n      sources\n    };\n  }\n\n  serialize(context) {\n    const {\n      write\n    } = context;\n    write(this.options);\n    super.serialize(context);\n  }\n\n  deserialize(context) {\n    const {\n      read\n    } = context;\n    this.options = read();\n    super.deserialize(context);\n  }\n\n}\n\nmakeSerializable(ConsumeSharedModule, \"webpack/lib/sharing/ConsumeSharedModule\");\nmodule.exports = ConsumeSharedModule;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/sharing/ConsumeSharedModule.js"],"names":["RawSource","require","AsyncDependenciesBlock","Module","RuntimeGlobals","makeSerializable","rangeToString","stringifyHoley","ConsumeSharedFallbackDependency","TYPES","Set","ConsumeSharedModule","constructor","context","options","identifier","shareKey","shareScope","importResolved","requiredVersion","strictVersion","singleton","eager","readableIdentifier","requestShortener","shorten","libIdent","import","request","layer","needBuild","callback","buildInfo","build","compilation","resolver","fs","buildMeta","dep","addDependency","block","addBlock","getSourceTypes","size","type","updateHash","hash","update","JSON","stringify","codeGeneration","chunkGraph","moduleGraph","runtimeTemplate","runtimeRequirements","shareScopeMap","fallbackCode","dependencies","syncModuleFactory","dependency","blocks","asyncModuleFactory","fn","args","push","code","returningFunction","join","sources","Map","set","serialize","write","deserialize","read","module","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\nconst { RawSource } = require(\"webpack-sources\");\nconst AsyncDependenciesBlock = require(\"../AsyncDependenciesBlock\");\nconst Module = require(\"../Module\");\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\nconst makeSerializable = require(\"../util/makeSerializable\");\nconst { rangeToString, stringifyHoley } = require(\"../util/semver\");\nconst ConsumeSharedFallbackDependency = require(\"./ConsumeSharedFallbackDependency\");\n\n/** @typedef {import(\"../../declarations/WebpackOptions\").WebpackOptionsNormalized} WebpackOptions */\n/** @typedef {import(\"../ChunkGraph\")} ChunkGraph */\n/** @typedef {import(\"../ChunkGroup\")} ChunkGroup */\n/** @typedef {import(\"../Compilation\")} Compilation */\n/** @typedef {import(\"../Dependency\").UpdateHashContext} UpdateHashContext */\n/** @typedef {import(\"../Module\").CodeGenerationContext} CodeGenerationContext */\n/** @typedef {import(\"../Module\").CodeGenerationResult} CodeGenerationResult */\n/** @typedef {import(\"../Module\").LibIdentOptions} LibIdentOptions */\n/** @typedef {import(\"../Module\").NeedBuildContext} NeedBuildContext */\n/** @typedef {import(\"../RequestShortener\")} RequestShortener */\n/** @typedef {import(\"../ResolverFactory\").ResolverWithOptions} ResolverWithOptions */\n/** @typedef {import(\"../WebpackError\")} WebpackError */\n/** @typedef {import(\"../util/Hash\")} Hash */\n/** @typedef {import(\"../util/fs\").InputFileSystem} InputFileSystem */\n/** @typedef {import(\"../util/semver\").SemVerRange} SemVerRange */\n\n/**\n * @typedef {Object} ConsumeOptions\n * @property {string=} import fallback request\n * @property {string=} importResolved resolved fallback request\n * @property {string} shareKey global share key\n * @property {string} shareScope share scope\n * @property {SemVerRange | false | undefined} requiredVersion version requirement\n * @property {string} packageName package name to determine required version automatically\n * @property {boolean} strictVersion don't use shared version even if version isn't valid\n * @property {boolean} singleton use single global version\n * @property {boolean} eager include the fallback module in a sync way\n */\n\nconst TYPES = new Set([\"consume-shared\"]);\n\nclass ConsumeSharedModule extends Module {\n\t/**\n\t * @param {string} context context\n\t * @param {ConsumeOptions} options consume options\n\t */\n\tconstructor(context, options) {\n\t\tsuper(\"consume-shared-module\", context);\n\t\tthis.options = options;\n\t}\n\n\t/**\n\t * @returns {string} a unique identifier of the module\n\t */\n\tidentifier() {\n\t\tconst {\n\t\t\tshareKey,\n\t\t\tshareScope,\n\t\t\timportResolved,\n\t\t\trequiredVersion,\n\t\t\tstrictVersion,\n\t\t\tsingleton,\n\t\t\teager\n\t\t} = this.options;\n\t\treturn `consume-shared-module|${shareScope}|${shareKey}|${\n\t\t\trequiredVersion && rangeToString(requiredVersion)\n\t\t}|${strictVersion}|${importResolved}|${singleton}|${eager}`;\n\t}\n\n\t/**\n\t * @param {RequestShortener} requestShortener the request shortener\n\t * @returns {string} a user readable identifier of the module\n\t */\n\treadableIdentifier(requestShortener) {\n\t\tconst {\n\t\t\tshareKey,\n\t\t\tshareScope,\n\t\t\timportResolved,\n\t\t\trequiredVersion,\n\t\t\tstrictVersion,\n\t\t\tsingleton,\n\t\t\teager\n\t\t} = this.options;\n\t\treturn `consume shared module (${shareScope}) ${shareKey}@${\n\t\t\trequiredVersion ? rangeToString(requiredVersion) : \"*\"\n\t\t}${strictVersion ? \" (strict)\" : \"\"}${singleton ? \" (singleton)\" : \"\"}${\n\t\t\timportResolved\n\t\t\t\t? ` (fallback: ${requestShortener.shorten(importResolved)})`\n\t\t\t\t: \"\"\n\t\t}${eager ? \" (eager)\" : \"\"}`;\n\t}\n\n\t/**\n\t * @param {LibIdentOptions} options options\n\t * @returns {string | null} an identifier for library inclusion\n\t */\n\tlibIdent(options) {\n\t\tconst { shareKey, shareScope, import: request } = this.options;\n\t\treturn `${\n\t\t\tthis.layer ? `(${this.layer})/` : \"\"\n\t\t}webpack/sharing/consume/${shareScope}/${shareKey}${\n\t\t\trequest ? `/${request}` : \"\"\n\t\t}`;\n\t}\n\n\t/**\n\t * @param {NeedBuildContext} context context info\n\t * @param {function((WebpackError | null)=, boolean=): void} callback callback function, returns true, if the module needs a rebuild\n\t * @returns {void}\n\t */\n\tneedBuild(context, callback) {\n\t\tcallback(null, !this.buildInfo);\n\t}\n\n\t/**\n\t * @param {WebpackOptions} options webpack options\n\t * @param {Compilation} compilation the compilation\n\t * @param {ResolverWithOptions} resolver the resolver\n\t * @param {InputFileSystem} fs the file system\n\t * @param {function(WebpackError=): void} callback callback function\n\t * @returns {void}\n\t */\n\tbuild(options, compilation, resolver, fs, callback) {\n\t\tthis.buildMeta = {};\n\t\tthis.buildInfo = {};\n\t\tif (this.options.import) {\n\t\t\tconst dep = new ConsumeSharedFallbackDependency(this.options.import);\n\t\t\tif (this.options.eager) {\n\t\t\t\tthis.addDependency(dep);\n\t\t\t} else {\n\t\t\t\tconst block = new AsyncDependenciesBlock({});\n\t\t\t\tblock.addDependency(dep);\n\t\t\t\tthis.addBlock(block);\n\t\t\t}\n\t\t}\n\t\tcallback();\n\t}\n\n\t/**\n\t * @returns {Set<string>} types available (do not mutate)\n\t */\n\tgetSourceTypes() {\n\t\treturn TYPES;\n\t}\n\n\t/**\n\t * @param {string=} type the source type for which the size should be estimated\n\t * @returns {number} the estimated size of the module (must be non-zero)\n\t */\n\tsize(type) {\n\t\treturn 42;\n\t}\n\n\t/**\n\t * @param {Hash} hash the hash used to track dependencies\n\t * @param {UpdateHashContext} context context\n\t * @returns {void}\n\t */\n\tupdateHash(hash, context) {\n\t\thash.update(JSON.stringify(this.options));\n\t\tsuper.updateHash(hash, context);\n\t}\n\n\t/**\n\t * @param {CodeGenerationContext} context context for code generation\n\t * @returns {CodeGenerationResult} result\n\t */\n\tcodeGeneration({ chunkGraph, moduleGraph, runtimeTemplate }) {\n\t\tconst runtimeRequirements = new Set([RuntimeGlobals.shareScopeMap]);\n\t\tconst {\n\t\t\tshareScope,\n\t\t\tshareKey,\n\t\t\tstrictVersion,\n\t\t\trequiredVersion,\n\t\t\timport: request,\n\t\t\tsingleton,\n\t\t\teager\n\t\t} = this.options;\n\t\tlet fallbackCode;\n\t\tif (request) {\n\t\t\tif (eager) {\n\t\t\t\tconst dep = this.dependencies[0];\n\t\t\t\tfallbackCode = runtimeTemplate.syncModuleFactory({\n\t\t\t\t\tdependency: dep,\n\t\t\t\t\tchunkGraph,\n\t\t\t\t\truntimeRequirements,\n\t\t\t\t\trequest: this.options.import\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst block = this.blocks[0];\n\t\t\t\tfallbackCode = runtimeTemplate.asyncModuleFactory({\n\t\t\t\t\tblock,\n\t\t\t\t\tchunkGraph,\n\t\t\t\t\truntimeRequirements,\n\t\t\t\t\trequest: this.options.import\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tlet fn = \"load\";\n\t\tconst args = [JSON.stringify(shareScope), JSON.stringify(shareKey)];\n\t\tif (requiredVersion) {\n\t\t\tif (strictVersion) {\n\t\t\t\tfn += \"Strict\";\n\t\t\t}\n\t\t\tif (singleton) {\n\t\t\t\tfn += \"Singleton\";\n\t\t\t}\n\t\t\targs.push(stringifyHoley(requiredVersion));\n\t\t\tfn += \"VersionCheck\";\n\t\t} else {\n\t\t\tif (singleton) {\n\t\t\t\tfn += \"Singleton\";\n\t\t\t}\n\t\t}\n\t\tif (fallbackCode) {\n\t\t\tfn += \"Fallback\";\n\t\t\targs.push(fallbackCode);\n\t\t}\n\t\tconst code = runtimeTemplate.returningFunction(`${fn}(${args.join(\", \")})`);\n\t\tconst sources = new Map();\n\t\tsources.set(\"consume-shared\", new RawSource(code));\n\t\treturn {\n\t\t\truntimeRequirements,\n\t\t\tsources\n\t\t};\n\t}\n\n\tserialize(context) {\n\t\tconst { write } = context;\n\t\twrite(this.options);\n\t\tsuper.serialize(context);\n\t}\n\n\tdeserialize(context) {\n\t\tconst { read } = context;\n\t\tthis.options = read();\n\t\tsuper.deserialize(context);\n\t}\n}\n\nmakeSerializable(\n\tConsumeSharedModule,\n\t\"webpack/lib/sharing/ConsumeSharedModule\"\n);\n\nmodule.exports = ConsumeSharedModule;\n"]},"metadata":{},"sourceType":"script"}