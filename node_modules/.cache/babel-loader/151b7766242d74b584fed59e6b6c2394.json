{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n/**\n * @template T\n * @template {Error} E\n * @param {Iterable<T>} items initial items\n * @param {number} concurrency number of items running in parallel\n * @param {function(T, function(T): void, function(E=): void): void} processor worker which pushes more items\n * @param {function(E=): void} callback all items processed\n * @returns {void}\n */\n\nconst processAsyncTree = (items, concurrency, processor, callback) => {\n  const queue = Array.from(items);\n  if (queue.length === 0) return callback();\n  let processing = 0;\n  let finished = false;\n  let processScheduled = true;\n\n  const push = item => {\n    queue.push(item);\n\n    if (!processScheduled && processing < concurrency) {\n      processScheduled = true;\n      process.nextTick(processQueue);\n    }\n  };\n\n  const processorCallback = err => {\n    processing--;\n\n    if (err && !finished) {\n      finished = true;\n      callback(err);\n      return;\n    }\n\n    if (!processScheduled) {\n      processScheduled = true;\n      process.nextTick(processQueue);\n    }\n  };\n\n  const processQueue = () => {\n    if (finished) return;\n\n    while (processing < concurrency && queue.length > 0) {\n      processing++;\n      const item = queue.pop();\n      processor(item, push, processorCallback);\n    }\n\n    processScheduled = false;\n\n    if (queue.length === 0 && processing === 0 && !finished) {\n      finished = true;\n      callback();\n    }\n  };\n\n  processQueue();\n};\n\nmodule.exports = processAsyncTree;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/util/processAsyncTree.js"],"names":["processAsyncTree","items","concurrency","processor","callback","queue","Array","from","length","processing","finished","processScheduled","push","item","process","nextTick","processQueue","processorCallback","err","pop","module","exports"],"mappings":"AAAA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAMA,gBAAgB,GAAG,CAACC,KAAD,EAAQC,WAAR,EAAqBC,SAArB,EAAgCC,QAAhC,KAA6C;AACrE,QAAMC,KAAK,GAAGC,KAAK,CAACC,IAAN,CAAWN,KAAX,CAAd;AACA,MAAII,KAAK,CAACG,MAAN,KAAiB,CAArB,EAAwB,OAAOJ,QAAQ,EAAf;AACxB,MAAIK,UAAU,GAAG,CAAjB;AACA,MAAIC,QAAQ,GAAG,KAAf;AACA,MAAIC,gBAAgB,GAAG,IAAvB;;AAEA,QAAMC,IAAI,GAAGC,IAAI,IAAI;AACpBR,IAAAA,KAAK,CAACO,IAAN,CAAWC,IAAX;;AACA,QAAI,CAACF,gBAAD,IAAqBF,UAAU,GAAGP,WAAtC,EAAmD;AAClDS,MAAAA,gBAAgB,GAAG,IAAnB;AACAG,MAAAA,OAAO,CAACC,QAAR,CAAiBC,YAAjB;AACA;AACD,GAND;;AAQA,QAAMC,iBAAiB,GAAGC,GAAG,IAAI;AAChCT,IAAAA,UAAU;;AACV,QAAIS,GAAG,IAAI,CAACR,QAAZ,EAAsB;AACrBA,MAAAA,QAAQ,GAAG,IAAX;AACAN,MAAAA,QAAQ,CAACc,GAAD,CAAR;AACA;AACA;;AACD,QAAI,CAACP,gBAAL,EAAuB;AACtBA,MAAAA,gBAAgB,GAAG,IAAnB;AACAG,MAAAA,OAAO,CAACC,QAAR,CAAiBC,YAAjB;AACA;AACD,GAXD;;AAaA,QAAMA,YAAY,GAAG,MAAM;AAC1B,QAAIN,QAAJ,EAAc;;AACd,WAAOD,UAAU,GAAGP,WAAb,IAA4BG,KAAK,CAACG,MAAN,GAAe,CAAlD,EAAqD;AACpDC,MAAAA,UAAU;AACV,YAAMI,IAAI,GAAGR,KAAK,CAACc,GAAN,EAAb;AACAhB,MAAAA,SAAS,CAACU,IAAD,EAAOD,IAAP,EAAaK,iBAAb,CAAT;AACA;;AACDN,IAAAA,gBAAgB,GAAG,KAAnB;;AACA,QAAIN,KAAK,CAACG,MAAN,KAAiB,CAAjB,IAAsBC,UAAU,KAAK,CAArC,IAA0C,CAACC,QAA/C,EAAyD;AACxDA,MAAAA,QAAQ,GAAG,IAAX;AACAN,MAAAA,QAAQ;AACR;AACD,GAZD;;AAcAY,EAAAA,YAAY;AACZ,CA3CD;;AA6CAI,MAAM,CAACC,OAAP,GAAiBrB,gBAAjB","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\n\"use strict\";\n\n/**\n * @template T\n * @template {Error} E\n * @param {Iterable<T>} items initial items\n * @param {number} concurrency number of items running in parallel\n * @param {function(T, function(T): void, function(E=): void): void} processor worker which pushes more items\n * @param {function(E=): void} callback all items processed\n * @returns {void}\n */\nconst processAsyncTree = (items, concurrency, processor, callback) => {\n\tconst queue = Array.from(items);\n\tif (queue.length === 0) return callback();\n\tlet processing = 0;\n\tlet finished = false;\n\tlet processScheduled = true;\n\n\tconst push = item => {\n\t\tqueue.push(item);\n\t\tif (!processScheduled && processing < concurrency) {\n\t\t\tprocessScheduled = true;\n\t\t\tprocess.nextTick(processQueue);\n\t\t}\n\t};\n\n\tconst processorCallback = err => {\n\t\tprocessing--;\n\t\tif (err && !finished) {\n\t\t\tfinished = true;\n\t\t\tcallback(err);\n\t\t\treturn;\n\t\t}\n\t\tif (!processScheduled) {\n\t\t\tprocessScheduled = true;\n\t\t\tprocess.nextTick(processQueue);\n\t\t}\n\t};\n\n\tconst processQueue = () => {\n\t\tif (finished) return;\n\t\twhile (processing < concurrency && queue.length > 0) {\n\t\t\tprocessing++;\n\t\t\tconst item = queue.pop();\n\t\t\tprocessor(item, push, processorCallback);\n\t\t}\n\t\tprocessScheduled = false;\n\t\tif (queue.length === 0 && processing === 0 && !finished) {\n\t\t\tfinished = true;\n\t\t\tcallback();\n\t\t}\n\t};\n\n\tprocessQueue();\n};\n\nmodule.exports = processAsyncTree;\n"]},"metadata":{},"sourceType":"script"}