{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n*/\n\"use strict\";\n\nconst {\n  SyncWaterfallHook\n} = require(\"tapable\");\n\nconst Compilation = require(\"../Compilation\");\n\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\n\nconst Template = require(\"../Template\");\n\nconst HelperRuntimeModule = require(\"./HelperRuntimeModule\");\n/** @typedef {import(\"../Chunk\")} Chunk */\n\n/** @typedef {import(\"../Compiler\")} Compiler */\n\n/**\n * @typedef {Object} LoadScriptCompilationHooks\n * @property {SyncWaterfallHook<[string, Chunk]>} createScript\n */\n\n/** @type {WeakMap<Compilation, LoadScriptCompilationHooks>} */\n\n\nconst compilationHooksMap = new WeakMap();\n\nclass LoadScriptRuntimeModule extends HelperRuntimeModule {\n  /**\n   * @param {Compilation} compilation the compilation\n   * @returns {LoadScriptCompilationHooks} hooks\n   */\n  static getCompilationHooks(compilation) {\n    if (!(compilation instanceof Compilation)) {\n      throw new TypeError(\"The 'compilation' argument must be an instance of Compilation\");\n    }\n\n    let hooks = compilationHooksMap.get(compilation);\n\n    if (hooks === undefined) {\n      hooks = {\n        createScript: new SyncWaterfallHook([\"source\", \"chunk\"])\n      };\n      compilationHooksMap.set(compilation, hooks);\n    }\n\n    return hooks;\n  }\n  /**\n   * @param {boolean=} withCreateScriptUrl use create script url for trusted types\n   */\n\n\n  constructor(withCreateScriptUrl) {\n    super(\"load script\");\n    this._withCreateScriptUrl = withCreateScriptUrl;\n  }\n  /**\n   * @returns {string} runtime code\n   */\n\n\n  generate() {\n    const {\n      compilation\n    } = this;\n    const {\n      runtimeTemplate,\n      outputOptions\n    } = compilation;\n    const {\n      scriptType,\n      chunkLoadTimeout: loadTimeout,\n      crossOriginLoading,\n      uniqueName,\n      charset\n    } = outputOptions;\n    const fn = RuntimeGlobals.loadScript;\n    const {\n      createScript\n    } = LoadScriptRuntimeModule.getCompilationHooks(compilation);\n    const code = Template.asString([\"script = document.createElement('script');\", scriptType ? `script.type = ${JSON.stringify(scriptType)};` : \"\", charset ? \"script.charset = 'utf-8';\" : \"\", `script.timeout = ${loadTimeout / 1000};`, `if (${RuntimeGlobals.scriptNonce}) {`, Template.indent(`script.setAttribute(\"nonce\", ${RuntimeGlobals.scriptNonce});`), \"}\", uniqueName ? 'script.setAttribute(\"data-webpack\", dataWebpackPrefix + key);' : \"\", `script.src = ${this._withCreateScriptUrl ? `${RuntimeGlobals.createScriptUrl}(url)` : \"url\"};`, crossOriginLoading ? Template.asString([\"if (script.src.indexOf(window.location.origin + '/') !== 0) {\", Template.indent(`script.crossOrigin = ${JSON.stringify(crossOriginLoading)};`), \"}\"]) : \"\"]);\n    return Template.asString([\"var inProgress = {};\", uniqueName ? `var dataWebpackPrefix = ${JSON.stringify(uniqueName + \":\")};` : \"// data-webpack is not used as build has no uniqueName\", \"// loadScript function to load a script via script tag\", `${fn} = ${runtimeTemplate.basicFunction(\"url, done, key, chunkId\", [\"if(inProgress[url]) { inProgress[url].push(done); return; }\", \"var script, needAttach;\", \"if(key !== undefined) {\", Template.indent(['var scripts = document.getElementsByTagName(\"script\");', \"for(var i = 0; i < scripts.length; i++) {\", Template.indent([\"var s = scripts[i];\", `if(s.getAttribute(\"src\") == url${uniqueName ? ' || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key' : \"\"}) { script = s; break; }`]), \"}\"]), \"}\", \"if(!script) {\", Template.indent([\"needAttach = true;\", createScript.call(code, this.chunk)]), \"}\", \"inProgress[url] = [done];\", \"var onScriptComplete = \" + runtimeTemplate.basicFunction(\"prev, event\", Template.asString([\"// avoid mem leaks in IE.\", \"script.onerror = script.onload = null;\", \"clearTimeout(timeout);\", \"var doneFns = inProgress[url];\", \"delete inProgress[url];\", \"script.parentNode && script.parentNode.removeChild(script);\", `doneFns && doneFns.forEach(${runtimeTemplate.returningFunction(\"fn(event)\", \"fn\")});`, \"if(prev) return prev(event);\"])), \";\", `var timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), ${loadTimeout});`, \"script.onerror = onScriptComplete.bind(null, script.onerror);\", \"script.onload = onScriptComplete.bind(null, script.onload);\", \"needAttach && document.head.appendChild(script);\"])};`]);\n  }\n\n}\n\nmodule.exports = LoadScriptRuntimeModule;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/runtime/LoadScriptRuntimeModule.js"],"names":["SyncWaterfallHook","require","Compilation","RuntimeGlobals","Template","HelperRuntimeModule","compilationHooksMap","WeakMap","LoadScriptRuntimeModule","getCompilationHooks","compilation","TypeError","hooks","get","undefined","createScript","set","constructor","withCreateScriptUrl","_withCreateScriptUrl","generate","runtimeTemplate","outputOptions","scriptType","chunkLoadTimeout","loadTimeout","crossOriginLoading","uniqueName","charset","fn","loadScript","code","asString","JSON","stringify","scriptNonce","indent","createScriptUrl","basicFunction","call","chunk","returningFunction","module","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n*/\n\n\"use strict\";\n\nconst { SyncWaterfallHook } = require(\"tapable\");\nconst Compilation = require(\"../Compilation\");\nconst RuntimeGlobals = require(\"../RuntimeGlobals\");\nconst Template = require(\"../Template\");\nconst HelperRuntimeModule = require(\"./HelperRuntimeModule\");\n\n/** @typedef {import(\"../Chunk\")} Chunk */\n/** @typedef {import(\"../Compiler\")} Compiler */\n\n/**\n * @typedef {Object} LoadScriptCompilationHooks\n * @property {SyncWaterfallHook<[string, Chunk]>} createScript\n */\n\n/** @type {WeakMap<Compilation, LoadScriptCompilationHooks>} */\nconst compilationHooksMap = new WeakMap();\n\nclass LoadScriptRuntimeModule extends HelperRuntimeModule {\n\t/**\n\t * @param {Compilation} compilation the compilation\n\t * @returns {LoadScriptCompilationHooks} hooks\n\t */\n\tstatic getCompilationHooks(compilation) {\n\t\tif (!(compilation instanceof Compilation)) {\n\t\t\tthrow new TypeError(\n\t\t\t\t\"The 'compilation' argument must be an instance of Compilation\"\n\t\t\t);\n\t\t}\n\t\tlet hooks = compilationHooksMap.get(compilation);\n\t\tif (hooks === undefined) {\n\t\t\thooks = {\n\t\t\t\tcreateScript: new SyncWaterfallHook([\"source\", \"chunk\"])\n\t\t\t};\n\t\t\tcompilationHooksMap.set(compilation, hooks);\n\t\t}\n\t\treturn hooks;\n\t}\n\n\t/**\n\t * @param {boolean=} withCreateScriptUrl use create script url for trusted types\n\t */\n\tconstructor(withCreateScriptUrl) {\n\t\tsuper(\"load script\");\n\t\tthis._withCreateScriptUrl = withCreateScriptUrl;\n\t}\n\n\t/**\n\t * @returns {string} runtime code\n\t */\n\tgenerate() {\n\t\tconst { compilation } = this;\n\t\tconst { runtimeTemplate, outputOptions } = compilation;\n\t\tconst {\n\t\t\tscriptType,\n\t\t\tchunkLoadTimeout: loadTimeout,\n\t\t\tcrossOriginLoading,\n\t\t\tuniqueName,\n\t\t\tcharset\n\t\t} = outputOptions;\n\t\tconst fn = RuntimeGlobals.loadScript;\n\n\t\tconst { createScript } =\n\t\t\tLoadScriptRuntimeModule.getCompilationHooks(compilation);\n\n\t\tconst code = Template.asString([\n\t\t\t\"script = document.createElement('script');\",\n\t\t\tscriptType ? `script.type = ${JSON.stringify(scriptType)};` : \"\",\n\t\t\tcharset ? \"script.charset = 'utf-8';\" : \"\",\n\t\t\t`script.timeout = ${loadTimeout / 1000};`,\n\t\t\t`if (${RuntimeGlobals.scriptNonce}) {`,\n\t\t\tTemplate.indent(\n\t\t\t\t`script.setAttribute(\"nonce\", ${RuntimeGlobals.scriptNonce});`\n\t\t\t),\n\t\t\t\"}\",\n\t\t\tuniqueName\n\t\t\t\t? 'script.setAttribute(\"data-webpack\", dataWebpackPrefix + key);'\n\t\t\t\t: \"\",\n\t\t\t`script.src = ${\n\t\t\t\tthis._withCreateScriptUrl\n\t\t\t\t\t? `${RuntimeGlobals.createScriptUrl}(url)`\n\t\t\t\t\t: \"url\"\n\t\t\t};`,\n\t\t\tcrossOriginLoading\n\t\t\t\t? Template.asString([\n\t\t\t\t\t\t\"if (script.src.indexOf(window.location.origin + '/') !== 0) {\",\n\t\t\t\t\t\tTemplate.indent(\n\t\t\t\t\t\t\t`script.crossOrigin = ${JSON.stringify(crossOriginLoading)};`\n\t\t\t\t\t\t),\n\t\t\t\t\t\t\"}\"\n\t\t\t\t  ])\n\t\t\t\t: \"\"\n\t\t]);\n\n\t\treturn Template.asString([\n\t\t\t\"var inProgress = {};\",\n\t\t\tuniqueName\n\t\t\t\t? `var dataWebpackPrefix = ${JSON.stringify(uniqueName + \":\")};`\n\t\t\t\t: \"// data-webpack is not used as build has no uniqueName\",\n\t\t\t\"// loadScript function to load a script via script tag\",\n\t\t\t`${fn} = ${runtimeTemplate.basicFunction(\"url, done, key, chunkId\", [\n\t\t\t\t\"if(inProgress[url]) { inProgress[url].push(done); return; }\",\n\t\t\t\t\"var script, needAttach;\",\n\t\t\t\t\"if(key !== undefined) {\",\n\t\t\t\tTemplate.indent([\n\t\t\t\t\t'var scripts = document.getElementsByTagName(\"script\");',\n\t\t\t\t\t\"for(var i = 0; i < scripts.length; i++) {\",\n\t\t\t\t\tTemplate.indent([\n\t\t\t\t\t\t\"var s = scripts[i];\",\n\t\t\t\t\t\t`if(s.getAttribute(\"src\") == url${\n\t\t\t\t\t\t\tuniqueName\n\t\t\t\t\t\t\t\t? ' || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key'\n\t\t\t\t\t\t\t\t: \"\"\n\t\t\t\t\t\t}) { script = s; break; }`\n\t\t\t\t\t]),\n\t\t\t\t\t\"}\"\n\t\t\t\t]),\n\t\t\t\t\"}\",\n\t\t\t\t\"if(!script) {\",\n\t\t\t\tTemplate.indent([\n\t\t\t\t\t\"needAttach = true;\",\n\t\t\t\t\tcreateScript.call(code, this.chunk)\n\t\t\t\t]),\n\t\t\t\t\"}\",\n\t\t\t\t\"inProgress[url] = [done];\",\n\t\t\t\t\"var onScriptComplete = \" +\n\t\t\t\t\truntimeTemplate.basicFunction(\n\t\t\t\t\t\t\"prev, event\",\n\t\t\t\t\t\tTemplate.asString([\n\t\t\t\t\t\t\t\"// avoid mem leaks in IE.\",\n\t\t\t\t\t\t\t\"script.onerror = script.onload = null;\",\n\t\t\t\t\t\t\t\"clearTimeout(timeout);\",\n\t\t\t\t\t\t\t\"var doneFns = inProgress[url];\",\n\t\t\t\t\t\t\t\"delete inProgress[url];\",\n\t\t\t\t\t\t\t\"script.parentNode && script.parentNode.removeChild(script);\",\n\t\t\t\t\t\t\t`doneFns && doneFns.forEach(${runtimeTemplate.returningFunction(\n\t\t\t\t\t\t\t\t\"fn(event)\",\n\t\t\t\t\t\t\t\t\"fn\"\n\t\t\t\t\t\t\t)});`,\n\t\t\t\t\t\t\t\"if(prev) return prev(event);\"\n\t\t\t\t\t\t])\n\t\t\t\t\t),\n\t\t\t\t\";\",\n\t\t\t\t`var timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), ${loadTimeout});`,\n\t\t\t\t\"script.onerror = onScriptComplete.bind(null, script.onerror);\",\n\t\t\t\t\"script.onload = onScriptComplete.bind(null, script.onload);\",\n\t\t\t\t\"needAttach && document.head.appendChild(script);\"\n\t\t\t])};`\n\t\t]);\n\t}\n}\n\nmodule.exports = LoadScriptRuntimeModule;\n"]},"metadata":{},"sourceType":"script"}