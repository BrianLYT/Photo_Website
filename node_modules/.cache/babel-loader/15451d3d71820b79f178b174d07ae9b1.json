{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Florent Cailhol @ooflorent\n*/\n\"use strict\";\n\nconst {\n  compareModulesByPreOrderIndexOrIdentifier\n} = require(\"../util/comparators\");\n\nconst {\n  getUsedModuleIdsAndModules,\n  getFullModuleName,\n  assignDeterministicIds\n} = require(\"./IdHelpers\");\n/** @typedef {import(\"../Compiler\")} Compiler */\n\n/** @typedef {import(\"../Module\")} Module */\n\n\nclass DeterministicModuleIdsPlugin {\n  /**\n   * @param {Object} options options\n   * @param {string=} options.context context relative to which module identifiers are computed\n   * @param {function(Module): boolean=} options.test selector function for modules\n   * @param {number=} options.maxLength maximum id length in digits (used as starting point)\n   * @param {number=} options.salt hash salt for ids\n   * @param {boolean=} options.fixedLength do not increase the maxLength to find an optimal id space size\n   * @param {boolean=} options.failOnConflict throw an error when id conflicts occur (instead of rehashing)\n   */\n  constructor() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.options = options;\n  }\n  /**\n   * Apply the plugin\n   * @param {Compiler} compiler the compiler instance\n   * @returns {void}\n   */\n\n\n  apply(compiler) {\n    compiler.hooks.compilation.tap(\"DeterministicModuleIdsPlugin\", compilation => {\n      compilation.hooks.moduleIds.tap(\"DeterministicModuleIdsPlugin\", () => {\n        const chunkGraph = compilation.chunkGraph;\n        const context = this.options.context ? this.options.context : compiler.context;\n        const maxLength = this.options.maxLength || 3;\n        const failOnConflict = this.options.failOnConflict || false;\n        const fixedLength = this.options.fixedLength || false;\n        const salt = this.options.salt || 0;\n        let conflicts = 0;\n        const [usedIds, modules] = getUsedModuleIdsAndModules(compilation, this.options.test);\n        assignDeterministicIds(modules, module => getFullModuleName(module, context, compiler.root), failOnConflict ? () => 0 : compareModulesByPreOrderIndexOrIdentifier(compilation.moduleGraph), (module, id) => {\n          const size = usedIds.size;\n          usedIds.add(`${id}`);\n\n          if (size === usedIds.size) {\n            conflicts++;\n            return false;\n          }\n\n          chunkGraph.setModuleId(module, id);\n          return true;\n        }, [Math.pow(10, maxLength)], fixedLength ? 0 : 10, usedIds.size, salt);\n        if (failOnConflict && conflicts) throw new Error(`Assigning deterministic module ids has lead to ${conflicts} conflict${conflicts > 1 ? \"s\" : \"\"}.\\nIncrease the 'maxLength' to increase the id space and make conflicts less likely (recommended when there are many conflicts or application is expected to grow), or add an 'salt' number to try another hash starting value in the same id space (recommended when there is only a single conflict).`);\n      });\n    });\n  }\n\n}\n\nmodule.exports = DeterministicModuleIdsPlugin;","map":{"version":3,"sources":["G:/0_coding/Side Project/photo-website/node_modules/webpack/lib/ids/DeterministicModuleIdsPlugin.js"],"names":["compareModulesByPreOrderIndexOrIdentifier","require","getUsedModuleIdsAndModules","getFullModuleName","assignDeterministicIds","DeterministicModuleIdsPlugin","constructor","options","apply","compiler","hooks","compilation","tap","moduleIds","chunkGraph","context","maxLength","failOnConflict","fixedLength","salt","conflicts","usedIds","modules","test","module","root","moduleGraph","id","size","add","setModuleId","Math","pow","Error","exports"],"mappings":"AAAA;AACA;AACA;AACA;AAEA;;AAEA,MAAM;AACLA,EAAAA;AADK,IAEFC,OAAO,CAAC,qBAAD,CAFX;;AAGA,MAAM;AACLC,EAAAA,0BADK;AAELC,EAAAA,iBAFK;AAGLC,EAAAA;AAHK,IAIFH,OAAO,CAAC,aAAD,CAJX;AAMA;;AACA;;;AAEA,MAAMI,4BAAN,CAAmC;AAClC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACCC,EAAAA,WAAW,GAAe;AAAA,QAAdC,OAAc,uEAAJ,EAAI;AACzB,SAAKA,OAAL,GAAeA,OAAf;AACA;AAED;AACD;AACA;AACA;AACA;;;AACCC,EAAAA,KAAK,CAACC,QAAD,EAAW;AACfA,IAAAA,QAAQ,CAACC,KAAT,CAAeC,WAAf,CAA2BC,GAA3B,CACC,8BADD,EAECD,WAAW,IAAI;AACdA,MAAAA,WAAW,CAACD,KAAZ,CAAkBG,SAAlB,CAA4BD,GAA5B,CAAgC,8BAAhC,EAAgE,MAAM;AACrE,cAAME,UAAU,GAAGH,WAAW,CAACG,UAA/B;AACA,cAAMC,OAAO,GAAG,KAAKR,OAAL,CAAaQ,OAAb,GACb,KAAKR,OAAL,CAAaQ,OADA,GAEbN,QAAQ,CAACM,OAFZ;AAGA,cAAMC,SAAS,GAAG,KAAKT,OAAL,CAAaS,SAAb,IAA0B,CAA5C;AACA,cAAMC,cAAc,GAAG,KAAKV,OAAL,CAAaU,cAAb,IAA+B,KAAtD;AACA,cAAMC,WAAW,GAAG,KAAKX,OAAL,CAAaW,WAAb,IAA4B,KAAhD;AACA,cAAMC,IAAI,GAAG,KAAKZ,OAAL,CAAaY,IAAb,IAAqB,CAAlC;AACA,YAAIC,SAAS,GAAG,CAAhB;AAEA,cAAM,CAACC,OAAD,EAAUC,OAAV,IAAqBpB,0BAA0B,CACpDS,WADoD,EAEpD,KAAKJ,OAAL,CAAagB,IAFuC,CAArD;AAIAnB,QAAAA,sBAAsB,CACrBkB,OADqB,EAErBE,MAAM,IAAIrB,iBAAiB,CAACqB,MAAD,EAAST,OAAT,EAAkBN,QAAQ,CAACgB,IAA3B,CAFN,EAGrBR,cAAc,GACX,MAAM,CADK,GAEXjB,yCAAyC,CACzCW,WAAW,CAACe,WAD6B,CALvB,EAQrB,CAACF,MAAD,EAASG,EAAT,KAAgB;AACf,gBAAMC,IAAI,GAAGP,OAAO,CAACO,IAArB;AACAP,UAAAA,OAAO,CAACQ,GAAR,CAAa,GAAEF,EAAG,EAAlB;;AACA,cAAIC,IAAI,KAAKP,OAAO,CAACO,IAArB,EAA2B;AAC1BR,YAAAA,SAAS;AACT,mBAAO,KAAP;AACA;;AACDN,UAAAA,UAAU,CAACgB,WAAX,CAAuBN,MAAvB,EAA+BG,EAA/B;AACA,iBAAO,IAAP;AACA,SAjBoB,EAkBrB,CAACI,IAAI,CAACC,GAAL,CAAS,EAAT,EAAahB,SAAb,CAAD,CAlBqB,EAmBrBE,WAAW,GAAG,CAAH,GAAO,EAnBG,EAoBrBG,OAAO,CAACO,IApBa,EAqBrBT,IArBqB,CAAtB;AAuBA,YAAIF,cAAc,IAAIG,SAAtB,EACC,MAAM,IAAIa,KAAJ,CACJ,kDAAiDb,SAAU,YAC3DA,SAAS,GAAG,CAAZ,GAAgB,GAAhB,GAAsB,EACtB,ySAHI,CAAN;AAKD,OA5CD;AA6CA,KAhDF;AAkDA;;AAtEiC;;AAyEnCI,MAAM,CAACU,OAAP,GAAiB7B,4BAAjB","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Florent Cailhol @ooflorent\n*/\n\n\"use strict\";\n\nconst {\n\tcompareModulesByPreOrderIndexOrIdentifier\n} = require(\"../util/comparators\");\nconst {\n\tgetUsedModuleIdsAndModules,\n\tgetFullModuleName,\n\tassignDeterministicIds\n} = require(\"./IdHelpers\");\n\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../Module\")} Module */\n\nclass DeterministicModuleIdsPlugin {\n\t/**\n\t * @param {Object} options options\n\t * @param {string=} options.context context relative to which module identifiers are computed\n\t * @param {function(Module): boolean=} options.test selector function for modules\n\t * @param {number=} options.maxLength maximum id length in digits (used as starting point)\n\t * @param {number=} options.salt hash salt for ids\n\t * @param {boolean=} options.fixedLength do not increase the maxLength to find an optimal id space size\n\t * @param {boolean=} options.failOnConflict throw an error when id conflicts occur (instead of rehashing)\n\t */\n\tconstructor(options = {}) {\n\t\tthis.options = options;\n\t}\n\n\t/**\n\t * Apply the plugin\n\t * @param {Compiler} compiler the compiler instance\n\t * @returns {void}\n\t */\n\tapply(compiler) {\n\t\tcompiler.hooks.compilation.tap(\n\t\t\t\"DeterministicModuleIdsPlugin\",\n\t\t\tcompilation => {\n\t\t\t\tcompilation.hooks.moduleIds.tap(\"DeterministicModuleIdsPlugin\", () => {\n\t\t\t\t\tconst chunkGraph = compilation.chunkGraph;\n\t\t\t\t\tconst context = this.options.context\n\t\t\t\t\t\t? this.options.context\n\t\t\t\t\t\t: compiler.context;\n\t\t\t\t\tconst maxLength = this.options.maxLength || 3;\n\t\t\t\t\tconst failOnConflict = this.options.failOnConflict || false;\n\t\t\t\t\tconst fixedLength = this.options.fixedLength || false;\n\t\t\t\t\tconst salt = this.options.salt || 0;\n\t\t\t\t\tlet conflicts = 0;\n\n\t\t\t\t\tconst [usedIds, modules] = getUsedModuleIdsAndModules(\n\t\t\t\t\t\tcompilation,\n\t\t\t\t\t\tthis.options.test\n\t\t\t\t\t);\n\t\t\t\t\tassignDeterministicIds(\n\t\t\t\t\t\tmodules,\n\t\t\t\t\t\tmodule => getFullModuleName(module, context, compiler.root),\n\t\t\t\t\t\tfailOnConflict\n\t\t\t\t\t\t\t? () => 0\n\t\t\t\t\t\t\t: compareModulesByPreOrderIndexOrIdentifier(\n\t\t\t\t\t\t\t\t\tcompilation.moduleGraph\n\t\t\t\t\t\t\t  ),\n\t\t\t\t\t\t(module, id) => {\n\t\t\t\t\t\t\tconst size = usedIds.size;\n\t\t\t\t\t\t\tusedIds.add(`${id}`);\n\t\t\t\t\t\t\tif (size === usedIds.size) {\n\t\t\t\t\t\t\t\tconflicts++;\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchunkGraph.setModuleId(module, id);\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t[Math.pow(10, maxLength)],\n\t\t\t\t\t\tfixedLength ? 0 : 10,\n\t\t\t\t\t\tusedIds.size,\n\t\t\t\t\t\tsalt\n\t\t\t\t\t);\n\t\t\t\t\tif (failOnConflict && conflicts)\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t`Assigning deterministic module ids has lead to ${conflicts} conflict${\n\t\t\t\t\t\t\t\tconflicts > 1 ? \"s\" : \"\"\n\t\t\t\t\t\t\t}.\\nIncrease the 'maxLength' to increase the id space and make conflicts less likely (recommended when there are many conflicts or application is expected to grow), or add an 'salt' number to try another hash starting value in the same id space (recommended when there is only a single conflict).`\n\t\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n}\n\nmodule.exports = DeterministicModuleIdsPlugin;\n"]},"metadata":{},"sourceType":"script"}